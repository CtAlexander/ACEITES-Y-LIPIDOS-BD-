<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aceites y L√≠pidos BD</title>
    <style>
        /* Marca de agua */
        .marca-de-agua {
            position: fixed;
            bottom: 0;
            right: 0;
            margin: 10px;
            opacity: 0.2;
            font-size: 50px;
            color: black;
            pointer-events: none;
        }

        /* Body Styling */
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #2a3c4f;
            color: #d0d0d0;
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 5%;
            background-size: cover;
            position: relative;
        }

        /* Onda verde en la pared izquierda */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 50%;
            height: 100%;
            background: radial-gradient(circle at 20% 50%, #00b954, transparent 70%);
            opacity: 0.15;
            z-index: -1;
        }

        /* Info Container */
        .info-container {
            color: #ffffff;
            max-width: 500px;
            margin-right: 5%;
        }

        .info-container h1 {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #00b954;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
        }

        .info-container ul {
            list-style-type: none;
            padding: 0;
        }

        .info-container li {
            margin-bottom: 20px;
            font-size: 18px;
        }

        .info-container li:before {
            content: '‚úîÔ∏è';
            color: #00ed64;
            margin-right: 10px;
        }

        /* Login/Signin Containers */
        .login-container, .signin-container {
            background-color: #ffffff;
            padding: 35px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            color: #000000;
            text-align: center;
            max-width: 400px;
            width: 100%;
        }

        h1 {
            color: #00b954;
            margin-bottom: 20px;
        }

        input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 8px;
            background-color: #f9f9f9;
            color: #333;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        input:focus {
            border-color: #00b954;
            outline: none;
        }

        /* Bot√≥n */
        .button {
            width: 100%;
            padding: 15px;
            background-color: #00b954;
            color: #fff;
            border: none;
            cursor: pointer;
            border-radius: 8px;
            font-size: 16px;
            transition: background-color 0.3s ease;
        }

        .button:hover {
            background-color: #009847;
        }

        /* Loading Container */
        .loading-container {
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 999;
        }

        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #00ed64;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Menu Container */
        .menu-container {
            display: none;
            background-color: transparent;
            padding: 40px;
            box-sizing: border-box;
            color: #000000;
            width: 100vw;
            height: 100vh;
            overflow-y: auto;
        }

        /* Tabs */
        .tabs {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }

        .tabs div {
            padding: 10px 20px;
            background-color: #4b5e6e;
            color: #fff;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .tabs div.active {
            background-color: #00b954;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Table Styling */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            font-size: 16px;
            color: #333;
        }

        table th, table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        table td {
            color: #00b954;
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        /* Links */
        .file-link {
            color: #00b954;
            text-decoration: none;
            transition: text-decoration 0.2s;
        }

        .file-link:hover {
            text-decoration: underline;
        }

        .no-file {
            color: #a9a9a9;
        }

        /* Switch Container */
        .switch-container {
            margin-top: 20px;
            text-align: center;
        }

        .switch-container a {
            color: #00b954;
            cursor: pointer;
            font-weight: bold;
            transition: color 0.3s ease;
        }

        .switch-container a:hover {
            color: #009847;
        }

        /* User Box */
        .user-box {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px;
            background-color: #00b954;
            color: #ffffff;
            border-radius: 50%;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease;
        }

        .user-box:hover {
            background-color: #009847;
        }

        /* Dropdown Menu */
        .dropdown-menu {
            display: none;
            position: absolute;
            top: 60px;
            right: 20px;
            background-color: #2a3c4f;
            border-radius: 8px;
            width: 200px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            color: #ffffff;
            font-size: 14px;
            z-index: 1000;
        }

        .dropdown-menu a {
            display: block;
            padding: 10px 15px;
            color: #ffffff;
            text-decoration: none;
            border-bottom: 1px solid #444;
        }

        .dropdown-menu a:hover {
            background-color: #00b954;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1001;
            padding-top: 60px;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(3px);
        }

        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 600px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .close:hover,
        .close:focus {
            color: #000;
        }

        /* Contenedor principal del organigrama */
        .organigrama-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
        }

/* Nuevo bot√≥n de tres puntos */
        .three-dots-menu {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 24px;
            cursor: pointer;
        }

        .three-dots-dropdown {
            display: none;
            position: absolute;
            top: 50px;
            left: 20px;
            background-color: #2a3c4f;
            color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            z-index: 1000;
        }

        .three-dots-dropdown a {
            display: block;
            padding: 10px 15px;
            color: #ffffff;
            text-decoration: none;
            border-bottom: 1px solid #444;
        }

        .three-dots-dropdown a:hover {
            background-color: #00b954;
        }

        .three-dots-dropdown a:last-child {
            border-bottom: none;
        }

       
    /* Estilo general del modal */
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        z-index: 9999;
        backdrop-filter: blur(8px);
        justify-content: center;
        align-items: center;
    }

    .modal-content {
        background: #ffffff;
        padding: 30px;
        border-radius: 15px;
        width: 90%;
        max-width: 400px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        text-align: center;
    }

    .modal-content h2 {
        margin-bottom: 20px;
        font-size: 24px;
        color: #00b954;
        text-transform: uppercase;
        font-weight: bold;
        letter-spacing: 1px;
    }

    .modal-content ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .modal-content ul li {
        margin: 15px 0;
    }

    .modal-content ul li a {
        text-decoration: none;
        font-size: 18px;
        font-weight: bold;
        color: #333;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 10px;
        border: 2px solid #00b954;
        border-radius: 8px;
        transition: all 0.3s ease;
    }

    .modal-content ul li a:hover {
        background: #00b954;
        color: #ffffff;
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }

    .modal-content ul li a img {
        margin-right: 10px;
    }

    .modal-content .close {
        position: absolute;
        top: 15px;
        right: 15px;
        font-size: 20px;
        color: #333;
        cursor: pointer;
        font-weight: bold;
        transition: color 0.3s ease;
    }

    .modal-content .close:hover {
        color: #00b954;
    }
/* Estilo del bot√≥n */
#normasIsoButton {
    background-color: #28a745; /* Color verde principal */
    color: #FFFFFF; /* Texto blanco */
    font-family: 'Arial', sans-serif; /* Fuente profesional */
    font-size: 14px; /* Tama√±o del texto m√°s peque√±o */
    padding: 10px 15px; /* Espaciado interno reducido */
    border: none; /* Sin borde */
    border-radius: 6px; /* Bordes redondeados */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Sombra m√°s peque√±a */
    cursor: pointer; /* Cambia el cursor al pasar */
    display: inline-block; /* Mantenerlo en l√≠nea */
    text-align: center; /* Centrar el contenido */
    transition: background-color 0.3s, box-shadow 0.3s; /* Efectos suaves */
    position: absolute; /* Posicionamiento absoluto */
    top: 20px; /* Despegado de la parte superior */
    right: 80px; /* Separado 50px de la esquina derecha */
}

/* Hover del bot√≥n */
#normasIsoButton:hover {
    background-color: #218838; /* Verde m√°s oscuro al pasar */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15); /* Aumenta la sombra */
}

/* Activo al presionar */
#normasIsoButton:active {
    background-color: #1e7e34; /* Verde m√°s intenso */
    box-shadow: 0 2px 3px rgba(0, 0, 0, 0.2); /* Reduce la sombra */
}

#pdfModal iframe {
    border: none;
}

.search-container {
    margin: 20px 0;
    display: flex;
    gap: 10px;
    align-items: center;
}

#searchInput {
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    flex-grow: 1;
}

#searchButton {
    padding: 10px 20px;
    background-color: #00b954;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}

#searchButton:hover {
    background-color: #009847;
}

.green-button {
    background-color: #28a745; /* Verde brillante */
    color: white; /* Texto blanco */
    border: none; /* Sin bordes */
    padding: 10px 20px; /* Espaciado interno */
    font-size: 16px; /* Tama√±o de fuente */
    font-weight: bold; /* Negrita */
    border-radius: 5px; /* Bordes redondeados */
    cursor: pointer; /* Cambia el cursor al pasar sobre el bot√≥n */
    transition: background-color 0.3s ease; /* Animaci√≥n al pasar el rat√≥n */
}

.green-button:hover {
    background-color: #218838; /* Verde m√°s oscuro al pasar el rat√≥n */
}

.green-button:active {
    background-color: #1e7e34; /* Verde a√∫n m√°s oscuro al hacer clic */
}

.pagination-button {
    display: inline-block;
    padding: 10px 15px;
    margin: 5px;
    background-color: #00b954; /* Verde */
    color: #ffffff; /* Blanco */
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    transition: background-color 0.3s;
}

.pagination-button:hover {
    background-color: #009847; /* Verde m√°s oscuro */
}

.pagination-button.active {
    background-color: #009847;
}

.green-button {
    background-color: #28a745; /* Verde brillante */
    color: white; /* Texto blanco */
    border: none; /* Sin bordes */
    padding: 10px 20px; /* Espaciado interno */
    font-size: 16px; /* Tama√±o de fuente */
    font-weight: bold; /* Negrita */
    border-radius: 5px; /* Bordes redondeados */
    cursor: pointer; /* Cambia el cursor al pasar sobre el bot√≥n */
    transition: background-color 0.3s ease; /* Animaci√≥n al pasar el rat√≥n */
    margin: 5px 0; /* Espaciado vertical entre botones */
}

.green-button:hover {
    background-color: #218838; /* Verde m√°s oscuro al pasar el rat√≥n */
}

.green-button:active {
    background-color: #1e7e34; /* Verde a√∫n m√°s oscuro al hacer clic */
}

.tabs {
    display: flex;
    justify-content: space-between;
    margin-bottom: 20px;
}

.tabs div {
    flex: 1;
    padding: 10px;
    text-align: center;
    background-color: #4b5e6e;
    color: white;
    border-radius: 5px;
    margin-right: 5px;
    cursor: pointer;
    font-weight: bold;
    transition: background-color 0.3s ease;
}

.tabs div.active {
    background-color: #00b954;
    color: white;
}

#requisitos-content {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    width: 100%; /* Asegura que ocupe todo el ancho disponible */
    margin: 0 auto; /* Centra horizontalmente */
    padding: 20px; /* Espaciado interno */
}

.tabs {
    display: flex;
    justify-content: center; /* Centra horizontalmente */
    gap: 10px; /* Espacio entre pesta√±as */
    margin-bottom: 20px; /* Espaciado debajo de las pesta√±as */
}

.tabs div {
    padding: 10px 20px;
    text-align: center;
    background-color: #4b5e6e; /* Fondo de las pesta√±as */
    color: white;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    transition: background-color 0.3s ease;
}

.tabs div.active {
    background-color: #00b954; /* Color de la pesta√±a activa */
}

h2 {
    color: #00b954; /* Verde del encabezado */
    margin-bottom: 20px;
    text-align: center;



.tabs {
    display: flex;
    justify-content: center; /* Centra las pesta√±as horizontalmente */
    gap: 10px; /* Espacio entre las pesta√±as */
    margin-bottom: 20px;
}

.tabs div {
    padding: 10px 20px;
    text-align: center;
    background-color: rgba(75, 94, 110, 0.7); /* Fondo semitransparente */
    color: white;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    transition: background-color 0.3s ease;
}

.tabs div.active {
    background-color: rgba(0, 185, 84, 0.7); /* Fondo activo semitransparente */
}


.tab-content {
    display: none;
    text-align: center; /* Centra el contenido dentro de cada pesta√±a */
    margin: 0 auto;
    background-color: rgba(0, 0, 0, 0.2); /* Fondo del contenido semitransparente */
    border-radius: 10px; /* Bordes redondeados */
    padding: 20px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); /* Sombra ligera */
}

.tab-content.active {
    display: block;
}

#content-mapa {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    height: 100%;
    padding: 20px;
    background-color: rgba(255, 255, 255, 0.1); /* Fondo transparente */
    text-align: center;
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); /* Sombra ligera */
}


#requisitos-content {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    width: 100%;
    margin: 0 auto;
    padding: 20px;
    background-color: rgba(0, 0, 0, 0.1); /* Fondo semitransparente */
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); /* Sombra ligera */
}


/* Tabs */
.tabs {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px; /* Espacio entre pesta√±as */
    margin-bottom: 20px;
}

.tabs div {
    padding: 10px 20px;
    text-align: center;
    background-color: rgba(75, 94, 110, 0.7);
    color: white;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    transition: background-color 0.3s ease;
}

.tabs div.active {
    background-color: rgba(0, 185, 84, 0.7);
}

.tab-content {
    display: none;
    text-align: center;
    margin: 0 auto;
    background-color: rgba(0, 0, 0, 0.2);
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
}

.tab-content.active {
    display: block;
}

#content-mapa {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    height: 100%;
    padding: 20px;
    background-color: rgba(255, 255, 255, 0.1);
    text-align: center;
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
}

#requisitos-content {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    width: 100%;
    margin: 0 auto;
    padding: 20px;
    background-color: rgba(0, 0, 0, 0.1);
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
}



/* Ajustar la posici√≥n de las pesta√±as */
.tabs {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin: 0; /* Sin margen */
    padding: 10px 0;
    position: sticky; /* Fijo en la parte superior */
    top: 0;
    background-color: rgba(0, 0, 0, 0.8); /* Fondo semitransparente */
    z-index: 10;
}

/* Pesta√±as individuales */
.tabs div {
    padding: 10px 20px;
    text-align: center;
    background-color: rgba(75, 94, 110, 0.7); /* Fondo semitransparente */
    color: white;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    transition: background-color 0.3s ease;
}

.tabs div.active {
    background-color: rgba(0, 185, 84, 0.7); /* Fondo activo semitransparente */
}

/* Contenido de las pesta√±as */
.tab-content {
    display: none;
    margin-top: 10px;
    padding: 20px;
    background-color: rgba(0, 0, 0, 0.1); /* Fondo semitransparente */
    border-radius: 10px;
    text-align: center;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); /* Sombra ligera */
}

/* Mostrar el contenido activo */
.tab-content.active {
    display: block;
}

/* Contenido espec√≠fico para el Mapa de Procesos */
#content-mapa {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    text-align: center;
    margin-top: 20px;
}

#mapa-procesos-img {
    max-width: 80%;
    height: auto;
    border: 2px solid #ddd; /* Borde decorativo */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Sombra para la imagen */

 }
   
#content-mapa {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    height: 100%;
    padding: 20px;
    background-color: transparent; /* Fondo transparente */
    text-align: center;
    border-radius: 10px; /* Opcional: Bordes redondeados */
    box-shadow: none; /* Elimina cualquier sombra */
}

#mapa-procesos-img {
    max-width: 90%; /* Ajusta al tama√±o del contenedor */
    height: auto;
    border: none; /* Elimina cualquier borde */
    box-shadow: none; /* Elimina cualquier sombra */
    background-color: transparent; /* Asegura que no haya fondo en la imagen */
}

/* Letras negras solo en el modal del perfil */
#profileModal p, #profileModal h2, #profileModal span {
    color: #000000; /* Cambiar a negro */
}

/* Aseguramos que los textos dentro del modal tengan el estilo */
#profileModal strong {
    color: #000000; /* T√≠tulos destacados en negro */
}

.dropdown-menu {
    display: none;
}

 /* üîπ Estilo solo para los botones del men√∫ de pesta√±as */
#listsDropdownMenu {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin: 15px 0;
}

#listsDropdownMenu a {
  display: inline-block;
  padding: 10px 18px;
  border-radius: 8px;
  background: linear-gradient(135deg, #4facfe, #00f2fe);
  color: white;
  text-decoration: none;
  font-weight: 600;
  transition: all 0.3s ease;
  box-shadow: 0 2px 5px rgba(0,0,0,0.15);
}

#listsDropdownMenu a:hover {
  background: linear-gradient(135deg, #43e97b, #38f9d7);
  transform: translateY(-2px);
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}

#listsDropdownMenu a:active {
  transform: scale(0.95);
}

/* üîπ Bot√≥n activo (cuando se seleccione una pesta√±a) */
#listsDropdownMenu a.active {
  background: linear-gradient(135deg, #ff6a00, #ee0979);
  box-shadow: 0 4px 12px rgba(0,0,0,0.25);
}

    /* üîπ Contenedor de contenido */
    .listContent {
      display: none;
      padding: 20px;
      background: white;
      border-radius: 8px;
      margin: 20px auto;
      width: 80%;
      box-shadow: 0px 4px 10px rgba(0,0,0,0.1);
    }

    .listContent.active {
      display: block;
    }

/* Fondo del modal */
.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.8); /* Fondo oscuro */
}

/* Contenedor del modal */
.modal-content {
    background-color: #fff;
    margin: auto;
    padding: 0;
    border-radius: 8px;
    width: 95%; /* Ocupa el 95% del ancho de la pantalla */
    height: 95%; /* Ocupa el 95% de la altura de la pantalla */
    text-align: center;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    overflow: hidden;
    position: relative;
}


/* Encabezado del modal */
#orgChartHeader {
    margin: 0;
    padding: 10px;
    font-size: 24px;
    background-color: #f4f4f4;
    text-align: center;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

/* Iframe del PDF */
iframe {
    width: 100%; /* Ocupa todo el ancho del contenedor */
    height: calc(100% - 50px); /* Altura restante despu√©s del encabezado */
    border: none;
}

#alfaAssistant {
    background: linear-gradient(135deg, #28a745, #218838); /* Gradiente verde */
    color: #ffffff; /* Texto blanco */
    font-size: 16px; /* Tama√±o de fuente ligeramente m√°s grande */
    font-weight: bold;
    text-align: center;
    border-radius: 50%;
    width: 60px; /* Bot√≥n m√°s grande para mayor visibilidad */
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    position: absolute;
    top: 20px;
    right: 30px; /* Ajuste para moverlo m√°s a la izquierda */
    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2); /* Sombra m√°s pronunciada */
    transition: all 0.3s ease;
}

#alfaAssistant:hover {
    background: linear-gradient(135deg, #218838, #1e7e34); /* Gradiente m√°s oscuro en hover */
    transform: scale(1.1); /* Aumenta el tama√±o ligeramente */
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3); /* Sombra m√°s intensa */
}

#alfaAssistant:active {
    transform: scale(0.95); /* Leve reducci√≥n al hacer clic */
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2); /* Reduce la sombra */
}




</style>

</style>

    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
</head>
<body>

<div id="pdfModal" class="modal">
    <div class="modal-content" style="width: 90%; height: 90%; max-width: 1200px; max-height: 800px;">
        <span class="close" id="closePdfModal">&times;</span>
        <h2>Normas ISO</h2>

        <!-- Selector de Normas -->
        <select id="normasSelector">
            <option value="iso9001">ISO 9001:2015</option>
            <option value="iso22000">ISO 22000:2018</option>
        </select>

        <!-- Buscador en el documento -->
        <div class="search-container" style="margin: 20px 0; display: flex; gap: 10px;">
            <input type="text" id="searchInput" placeholder="Buscar en el documento" style="flex-grow: 1; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">
            <button id="searchButton" style="padding: 10px 20px; background-color: #00b954; color: white; border: none; border-radius: 5px; cursor: pointer;">Buscar</button>
        </div>

        <div style="margin: 20px 0; display: flex; justify-content: center; gap: 20px;">
    <button id="prevMatchButton" style="padding: 10px; font-size: 18px;">‚¨ÖÔ∏è Anterior</button>
    <button id="nextMatchButton" style="padding: 10px; font-size: 18px;">‚û°Ô∏è Siguiente</button>
</div>
<div id="pdfViewerContainer" style="width: 100%; height: auto; overflow-y: auto;"></div>

    </div>
</div>








    <!-- Contenedor de usuario y men√∫ desplegable -->
    <div class="user-box" id="user-box">üë§</div>
      <div class="user-box" id="normasIsoButton">üìú Normas ISO</div>
      

    <div class="dropdown-menu" id="dropdown-menu">
        <a href="#" id="viewProfile">Ver mi perfil</a>
        <a href="#" id="openOrgChart">Ver mi puesto y responsabilidades</a>
         <a href="#" id="alfaAssistant">ü§ñ Alfa</a>
        <a href="#" id="logout">Cerrar sesi√≥n</a>
        
    </div>
    <div class="marca-de-agua">ALFA 4 Innovaci√≥n</div>

   <!-- Modal para el organigrama -->
<div id="orgChartModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" id="closeOrgChart">&times;</span>
        <!-- Encabezado -->
        <h2 id="orgChartHeader">Organigrama</h2>
        <!-- Iframe para el PDF -->
        <iframe 
            id="orgChartIframe"
            src="https://firebasestorage.googleapis.com/v0/b/plataforma-39bde.appspot.com/o/organigramamarzo.pdf?alt=media&token=062b24e4-d8b9-46b8-8961-5ecb566c7c54"
            title="Organigrama">
        </iframe>
    </div>
</div>


  <!-- Modal para el perfil de usuario -->
    <div id="profileModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeProfile">&times;</span>
            <h2>Mi Perfil</h2>
            <p><strong>Nombre:</strong> <span id="userName"></span></p>
            <p><strong>Apellido:</strong> <span id="userLastName"></span></p>
            <p><strong>perfil:</strong> <span id="userRole"></span></p>
            <p><strong>Correo Electr√≥nico:</strong> <span id="userEmail"></span></p>
        </div>
    </div>

    <!-- Contenedor de la informaci√≥n -->
    <div class="info-container" id="info-container">
        <h1>Aceites y L√≠pidos BD</h1>
        <ul>
            <li>
                <p><strong>Pol√≠tica de calidad e inocuidad alineada a ISO 9001:2015 e ISO 22000:2018</strong><br>
               En Aceites y L√≠pidos BD nos comprometemos a: Proveer aceites y mantecas comestibles, desarrollando y adecuando las formulaciones de nuevos productos, cumpliendo con las regulaciones nacionales e internacionales.</p>
            </li>
            <li>
                <p>Contar con personal competente, gestionando los impactos del cambio clim√°tico en nuestros procesos y resultados, comunicando de manera efectiva con todas las partes interesadas para satisfacer sus necesidades y expectativas..</p>
            </li>
            <li>
                <p>Lograr la mejora continua otorgando asesor√≠a para el manejo de nuestra gama de productos y desarrollos, aplicando nuestros productos en la elaboraci√≥n de productos de nuestros clientes, generando una total confianza y satisfacci√≥n plena en nuestros clientes.</p>
            </li>
        </ul>
    </div>

    <!-- Contenedor de login y registro -->
    <div class="login-container" id="register-screen">
        <h1>Crear cuenta</h1>
        <input type="text" id="nombre" placeholder="Nombre" required>
        <input type="text" id="apellido" placeholder="Apellido" required>
        <input type="text" id="rol" placeholder="perfil" required>
        <input type="email" id="email" placeholder="Correo Electr√≥nico" required>
        <input type="password" id="password" placeholder="Contrase√±a" required>
        <button class="button" id="registerBtn">Crear cuenta</button>
        <div class="switch-container">
            <p>¬øYa tienes cuenta? <a id="switchToSignIn">Iniciar sesi√≥n</a></p>
        </div>
    </div>

    <div class="signin-container" id="signin-screen" style="display: none;">
        <h1>Iniciar sesi√≥n</h1>
        <input type="email" id="loginEmail" placeholder="Correo Electr√≥nico" required>
        <input type="password" id="loginPassword" placeholder="Contrase√±a" required>
        <button class="button" id="loginBtn">Iniciar sesi√≥n</button>
        <div class="switch-container">
            <p>¬øNo tienes cuenta? <a id="switchToRegister">Crear cuenta</a></p>
        </div>
    </div>

    <div class="loading-container" id="loading-screen">
        <div class="loader"></div>
        <p>Cargando...</p>
    </div>

<div class="menu-container" id="menu-screen">
    <h1>ACEITES Y LIPIDOS BD TE DA LA BIENVENIDA</h1>


    <div class="tabs">
    <div id="tab-home" class="active">Inicio</div>
    <div id="tab-lists">Listas</div>
    <div id="tab-files">Formatos </div>
    <div id="tab-requisitos">Requisitos</div>
    <div id="tab-mapa">Mapa de Procesos</div>
    <div id="tab-procedimientos">Procedimientos</div>
    <div id="tab-inocuidad">Pol√≠tica de Inocuidad</div>


</div>




    <!-- Contenido de Inicio -->
    <div id="home" class="tab-content active">
        <h2></h2>
        <p></p>
        <div class="info-container">
            <li>
                <p><strong>Objetivo:</strong><br>Consolidar la documentaci√≥n del Sistema de gesti√≥n de la calidad, y la total implementaci√≥n del An√°lisis de Peligros y Puntos Cr√≠ticos de Control, (HACCP) para la futura implementaci√≥n del SGI (calidad¬†e¬†inocuidad).</p>
            </li>
            <li>
                <p><strong>Alcance:</strong><br>
                    Formulaci√≥n, envasado y distribuci√≥n de aceites y mantecas vegetales comestibles; as√≠ como la comercializaci√≥n de materias primas asociadas..</p>
            </li>
        </div>
        <!-- Bot√≥n para cargar el archivo HACCP -->
        <button id="btn-haccp" class="green-button">Manual HACCP</button>
        <button id="btn-proceso" class="green-button">Procedimiento Acciones para abordar riesgos y oportunidades y 
revisi√≥n directiva</button>

        <button id="btn-calidad" class="green-button">Manual de Gesti√≥n de Calidad</button>


        
        <!-- Contenedor para mostrar el PDF -->
        <div id="pdf-container" style="display: none; margin-top: 20px;">
            <iframe id="pdf-viewer" style="width: 100%; height: 600px; border: none;"></iframe>
        </div>
    </div>

<div id="pdf-container-proceso" style="display: none; margin-top: 20px;">
    <iframe id="pdf-viewer-proceso" style="width: 100%; height: 600px; border: none;"></iframe>
</div>

    
<div id="pdf-container-calidad" style="display: none; margin-top: 20px;">
    <iframe id="pdf-viewer-calidad" style="width: 100%; height: 600px; border: none;"></iframe>
</div>

        

       <div id="lists" class="tab-content">
   <h2>Lista Maestra</h2>

   <!-- üîπ Men√∫ de pesta√±as -->
   <div id="listsDropdownMenu" class="tabs-menu">
      <a href="#" data-type="documentada">Informaci√≥n Documentada Mantenida</a>
      <a href="#" data-type="externos">Documentos Externos</a>
      <a href="#" data-type="registros">Registros</a>
      <a href="#" data-type="perfil">Perfil Funcional</a>
      <a href="#" data-type="responsabilidades">Responsabilidades</a>
      <a href="#" data-type="SGC">SGI</a>
   </div>

   <!-- üîπ Buscador -->
   <div style="margin: 10px 0; display: flex; gap: 10px;">
      <input type="text" id="searchInputLists" placeholder="Buscar por nombre o c√≥digo..." style="padding: 10px; width: 70%; border-radius: 5px; border: 1px solid #ccc;">
      <button id="searchButtonLists" class="green-button" style="padding: 10px 20px;">Buscar</button>
   </div>

   <!-- üîπ Subir archivos -->
   <div style="margin: 15px 0; display: flex; gap: 10px; align-items: center;">
      <input type="file" id="fileInput-lists">
      <button class="green-button" onclick="uploadListFile('lists')">Subir archivo</button>
   </div>

   <!-- üîπ Tabla -->
   <div id="list-content">
      <table>
         <thead>
            <tr>
               <th>T√≠tulo</th>
               <th>C√≥digo</th>
               <th>Archivo</th>
            </tr>
         </thead>
         <tbody id="fileTableBody-lists"></tbody>
      </table>
   </div>

   <div id="pagination-container-files" style="margin-top: 20px; text-align: center;"></div>
</div>

  <!-- Men√∫ de tres puntos -->
 <div class="three-dots-menu" id="threeDotsMenu">‚ãÆ</div>
    <div class="three-dots-dropdown" id="threeDotsDropdown" style="display: none;">
        <a href="#" id="nonConformities">No conformidades</a>
        <a href="#" id="directiveDecisions">Decisiones directivas</a>
        <a href="#" id="correctiveActions">Acciones correctivas</a>
        <a href="#" id="otherOptions">Otras Opciones</a> <!-- Nueva opci√≥n -->
    </div>

    
  <div id="files" class="tab-content">
            <h2>Formatos</h2>
            <input type="file" id="fileInput" />
            <button class="button" id="uploadBtn">Subir Formatos </button>
            
            <table>
                <thead>
                    <tr>
                        <th>T√≠tulo</th>
                        <th>C√≥digo</th>
                        <th>Formato</th>
                    </tr>
                </thead>
                <tbody id="fileTableBody">
                </tbody>
            </table>
  <!-- Contenedor de paginaci√≥n -->
    


     </div>

     <div id="requisitos" class="tab-content">
  <h2 style="color: #00b954; text-align: center;">Selecci√≥n de Requisitos</h2>
  <div class="tabs" style="justify-content: center;">
    <div id="req-tab-contexto" class="active" onclick="handleRequisitosTab('contexto')">4.0 Contexto</div>
    <div id="req-tab-liderazgo" onclick="handleRequisitosTab('liderazgo')">5.0 Liderazgo</div>
    <div id="req-tab-planificacion" onclick="handleRequisitosTab('planificacion')">6.0 Planificaci√≥n</div>
    <div id="req-tab-apoyo" onclick="handleRequisitosTab('apoyo')">7.0 Apoyo</div>
    <div id="req-tab-operacion" onclick="handleRequisitosTab('operacion')">8.0 Operaci√≥n</div>
    <div id="req-tab-desempeno" onclick="handleRequisitosTab('desempeno')">9.0 Desempe√±o</div>
    <div id="req-tab-mejora" onclick="handleRequisitosTab('mejora')">10.0 Mejora</div>
  </div>
  
  <div id="requisitos-content" class="requisitos-content" style="margin-top: 20px;">
    <!-- Aqu√≠ se cargar√° el contenido din√°mico de cada secci√≥n -->
  </div>
</div>


<div id="content-mapa" class="tab-content">
    <h2>Mapa de Procesos</h2>
    <img id="mapa-procesos-img" src="https://firebasestorage.googleapis.com/v0/b/plataforma-39bde.appspot.com/o/Imagen%20de%20WhatsApp%202024-12-11%20a%20las%2019.25.14_8d4d0dbe.jpg?alt=media&token=7e62d2be-5127-4b8f-a74d-eed009aefaef" alt="Mapa de Procesos">
   
</div>


<div id="procedimientos" class="tab-content">
    <h2>Procedimientos</h2>
    <input type="file" id="fileInput-procedimientos" />
    <button class="button" id="uploadBtn-procedimientos">Subir Procedimientos</button>
    
    <table>
        <thead>
            <tr>
                <th>T√≠tulo</th>
                <th>C√≥digo</th>
                <th>Archivo</th>
            </tr>
        </thead>
        <tbody id="fileTableBody-procedimientos">
            <!-- Los archivos se cargar√°n din√°micamente aqu√≠ -->
        </tbody>
    </table>

    <!-- Contenedor de paginaci√≥n -->
    <div id="pagination-container-procedimientos" style="margin-top: 20px; text-align: center;"></div>
</div>





<div id="inocuidad" class="tab-content">
    <h2>Pol√≠tica de Inocuidad</h2>
    <div class="reglamento-container" style="text-align: justify; padding: 20px;">
        <p>Es obligatorio para todo el personal que labora en las instalaciones de la organizaci√≥n, as√≠ como todas aquellas personas externas a la operaci√≥n que ingresen a estas cumplir con las normas de buenas pr√°cticas de manufactura establecidas en el presente reglamento antes de entrar al √°rea de proceso.</p>
        <ol>
            <li>Todo el personal debe de practicar los siguientes h√°bitos de higiene personal:
                <ul>
                    <li>‚àö Presentarse aseado a laborar (ba√±ado y con ropa limpia incluyendo la interior).</li>
                    <li>‚àö Los hombres deben traer el cabello corto y limpio, en caso de usar bigote este deber ser recortado a la comisura del labio superior.</li>
                    <li>‚àö Las barbas y/o vello facial largo, quedan estrictamente prohibidos para el personal.</li>
                    <li>‚àö Usar desodorante y talco.</li>
                    <li>‚àö Lavarse los dientes.</li>
                    <li>‚àö Rasurarse diariamente.</li>
                    <li>‚àö Las u√±as deber√°n usarse cortas, limpias y sin esmalte.</li>
                    <li>‚àö Se permite el uso de patillas siempre que est√©n recortadas y que no se extiendan m√°s all√° del l√≥bulo inferior de la oreja.</li>
                    <li>‚àö Prohibido el uso de maquillaje en √°reas operativas.</li>
                    <li>‚àö Portar uniforme limpio y completo, mismo que deber√° traerlo al centro de trabajo dentro de una bolsa pl√°stica limpia.</li>
                    <li>‚àö Solo se permite el uso de zapatos cerrados y de suela antideslizante; deber√°n mantenerse limpios y en buenas condiciones. El uso de tenis dentro del √°rea de proceso no est√° permitido.</li>
                </ul>
            </li>
            <li>Todo personal operativo no debe exhibir lesiones y/o infecciones en piel, gastrointestinales, garganta y o√≠dos y en caso de presentar alguna notificar al Titular del √°rea para que se tomen las medidas preventivas.</li>
            <li>Debe portar correctamente el uniforme designado a su √°rea.</li>
            <li>Utilizar √∫nicamente los materiales y/o uniformes asignados a su √°rea, en caso de requerir algo distinto debe consultar con el √°rea Titular de √°rea y/o Aseguramiento de Calidad.</li>
            <li>Prohibido el uso de joyas, pulseras, dijes, reloj, escapularios, piercings o adornos ya que estos se pueden desprender y caer en el producto.</li>
            <li>Prohibido alterar el uniforme, equipo de trabajo o seguridad, escribiendo sobre √©l o colocando calcoman√≠as, fuera de lo oficialmente designado.</li>
            <li>Todo el personal que ingrese a las √°reas operativas deber√° lavar y sanear las manos correctamente:
                <ul>
                    <li>‚àö Antes de iniciar labores.</li>
                    <li>‚àö Antes de manipular los productos.</li>
                    <li>‚àö Antes y despu√©s de comer.</li>
                    <li>‚àö Despu√©s de ir al servicio sanitario.</li>
                    <li>‚àö Despu√©s de toser, estornudar o tocarse la nariz.</li>
                    <li>‚àö Despu√©s de manipular residuos.</li>
                </ul>
            </li>
            <li>En las zonas donde se manipule productos est√° prohibido todo acto que pueda resultar en contaminaci√≥n de estos. El personal debe evitar pr√°cticas inadecuadas y antihigi√©nicas como rascarse la cabeza, tocarse la frente, introducir los dedos en las orejas, nariz y boca, entre otros.</li>
            <li>Prohibido sentarse en el piso con el uniforme puesto, aplica dentro y fuera de las instalaciones de la planta.</li>
            <li>Prohibido consumir alimentos, dulces, bebidas, mascar chicle, fumar o escupir dentro de √°reas operativas y solo ser√° permitido en las √°reas establecidas para tal fin.</li>
            <li>Todo personal que toque algo que cay√≥ o tuvo contacto con el piso debe lavarse las manos antes de continuar sus tareas.</li>
            <li>Prohibido colocar el producto y utensilios de trabajo en el piso.</li>
            <li>El personal s√≥lo se limitar√° a realizar sus actividades indicadas dentro de su √°rea, as√≠ como aquellas otras que le sea designadas por su competencia.</li>
            <li>En caso de que el producto que est√° siendo elaborado caiga al piso, inmediatamente debe desecharse.</li>
            <li>En caso de que cualquier utensilio que caiga al piso debe ser lavado y saneado nuevamente antes de ser usado.</li>
            <li>Debe respetarse lo documentado en los Procedimientos Operativos Estandarizados de Saneamiento (POES).</li>
            <li>No colocar utensilios de limpieza sobre equipos, zonas de contacto con el producto o sobre piso sucio.</li>
            <li>Se deben de guardar los materiales de limpieza, qu√≠micos y otras sustancias peligrosas en el lugar asignado, bajo llave y con acceso restringido.</li>
            <li>Deben lavarse todos los equipos, utensilios y accesorios empleados en la elaboraci√≥n de productos al finalizar su uso evitando dejar residuos.</li>
            <li>El personal debe separar o segregar el producto no conforme en el √°rea designada para esta actividad.</li>
            <li>El personal debe de seguir el Sistema de almacenamiento y rotaci√≥n de stock establecido primeras entradas-primeras salidas (PEPS).</li>
            <li>Todo personal que eval√∫e producto en proceso antes de que lo toque debe sanear sus manos para evitar contaminaci√≥n cruzada.</li>
            <li>Todo personal que realice actividades que afecten la calidad del producto y/o inocuidad de estos por ning√∫n motivo debe realizar actividades que pongan en riesgo la calidad e inocuidad del producto.</li>
            <li>Todo el personal que ingrese al √°rea de proceso deber√° cubrir su cabeza con una cofia. El cabello deber√° usarse de preferencia corto; aquellas personas con cabello largo deber√°n sujetarlo para que no salga de la cofia.</li>
            <li>Todo el personal que entre en contacto con producto o superficies en contacto con el alimento debe cubrirse la boca y la nariz con un cubrebocas o mascarilla.</li>
            <li>Los objetos personales y ropa deben guardarse √∫nicamente en casilleros asignados para ello.</li>
            <li>Todo el personal debe mantener aseado el lugar en que desempe√±an su trabajo, as√≠ como conservar en buen estado y operar los equipos y utensilios proporcionados.</li>
            <li>Todo el personal debe contribuir a contar con un ambiente laboral de cordialidad y respeto.</li>
            <li>Conducirse en el centro de trabajo en forma segura para evitar cualquier riesgo en su persona y/o en la inocuidad del producto.</li>
            <li>Someterse a los ex√°menes m√©dicos que establezca el √°rea de Recursos Humanos trat√°ndose de trabajadores que interact√∫an con alimentos.</li>
            <li>Participar en la capacitaci√≥n, adiestramiento y eventos de informaci√≥n que el √°rea de Recursos Humanos programe.</li>
            <li>Informar al Titular de Recursos Humanos sobre sus posibles limitaciones para realizar actividades.</li>
            <li>Avisar inmediatamente al Titular del √°rea y/o Aseguramiento de Calidad sobre condiciones inseguras o accidentes de trabajo.</li>
        </ol>
    </div>
</div>


<script type="module">
            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js";
import { getFirestore, doc, setDoc, getDoc, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js";
import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-storage.js";

// Configuraci√≥n de Firebase (aseg√∫rate de que ya tienes Firebase configurado)


const firebaseConfig = {
    apiKey: "AIzaSyD323PEVx7xnnBWpMr2usOEEFQQ20YUcD8",
    authDomain: "plataforma-39bde.firebaseapp.com",
    databaseURL: "https://plataforma-39bde-default-rtdb.firebaseio.com",
    projectId: "plataforma-39bde",
    storageBucket: "plataforma-39bde.appspot.com",
    messagingSenderId: "313253115880",
    appId: "1:313253115880:web:fcaf513b16c4f892ae965d",
    measurementId: "G-D959K30F9R"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const storage = getStorage(app);



async function subirAprendizaje(tema, contenido) {
  const fecha = new Date().toISOString();
  const data = {
    alfa: "Alfa Aceites y L√≠pidos",
    tema: tema,
    contenido: contenido,
    fecha: fecha
  };

  const url = `https://ia-alfa-default-rtdb.firebaseio.com/colmena/Alfa_Aceites_Lipidos/aprendizajes/${fecha}.json`;

  try {
    const res = await fetch(url, {
      method: "PUT",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });
    const resData = await res.json();
    console.log("‚úÖ Aprendizaje enviado:", resData);
  } catch (err) {
    console.error("‚ùå Error al subir aprendizaje:", err);
  }
}




/***********************************************
 * CONFIGURACI√ìN Y VARIABLES GLOBALES
 ***********************************************/
const alfaAssistant = document.getElementById('alfaAssistant');
const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
const recognition = new SpeechRecognition();
recognition.lang = 'es-ES';

let currentUserName = "";
let listening = false;                // ¬øAlfa est√° escuchando?
const synth = window.speechSynthesis; // S√≠ntesis de voz
let isSpeaking = false;               // ¬øAlfa est√° hablando?
let activationListening = true;       // ¬øAlfa espera el comando de activaci√≥n?
let awaitingSearchQuery = false;      // ¬øEsperando consulta de b√∫squeda?
let awaitingVisitResponse = false;    // ¬øEsperando respuesta para visitar enlace?
let awaitingFileQuery = false;        // ¬øEsperando nombre de archivo a abrir?
let pendingLink = "";                 // Enlace pendiente a abrir

// Configuraci√≥n para b√∫squeda personalizada (Google Custom Search)
const GOOGLE_API_KEY = "AIzaSyADtBrzg5IgZbyCnxUe63DDlQ4Va02fMoQ"; // Tu API key
const SEARCH_ENGINE_ID = "343891ef8427a45dd";                        // Tu ID de motor de b√∫squeda

/***********************************************
 * FUNCIONES AUXILIARES
 ***********************************************/

/**
 * Funci√≥n para sintetizar voz.
 * @param {string} text Texto a reproducir.
 */
function speak(text) {
    isSpeaking = true;
    const utterance = new SpeechSynthesisUtterance(text);
    utterance.lang = 'es-ES';
    utterance.onend = () => { isSpeaking = false; };
    synth.speak(utterance);
}

/**
 * Muestra el contenido de una pesta√±a dado su ID.
 * @param {string} tabId Identificador de la pesta√±a a mostrar.
 */
function showTabContent(tabId) {
    const tabContents = document.querySelectorAll('.tab-content');
    const tabs = document.querySelectorAll('.tabs div');

    tabContents.forEach(content => {
        content.classList.remove('active');
        content.style.display = 'none';
    });
    tabs.forEach(tab => tab.classList.remove('active'));

    const activeContent = document.getElementById(tabId);
    const activeTab = document.getElementById(`tab-${tabId}`);
    if (activeContent) {
        activeContent.classList.add('active');
        activeContent.style.display = 'block';
    } else {
        console.error(`No se encontr√≥ el contenido de la pesta√±a con ID: ${tabId}`);
    }
    if (activeTab) {
        activeTab.classList.add('active');
    } else {
        console.error(`No se encontr√≥ el bot√≥n de la pesta√±a con ID: tab-${tabId}`);
    }
}

/**
 * Retorna el nombre de la colecci√≥n en funci√≥n de la pesta√±a.
 * @param {string} tabName Nombre de la pesta√±a.
 * @returns {string|null} Nombre de la colecci√≥n o null si no existe.
 */
function getCollectionNameFromTab(tabName) {
    const tabMap = {
        'listas': 'files-lists',
        'formatos': 'files-formats',
        'requisitos': 'files-requisitos',
        'procedimientos': 'files-procedimientos',
        'inocuidad': 'files-inocuidad'
    };
    return tabMap[tabName] || null;
}

/***********************************************
 * INICIALIZACI√ìN Y CONFIGURACI√ìN DE VOZ
 ***********************************************/

/**
 * Inicializa Alfa comprobando el usuario y salud√°ndolo.
 */
async function initializeAlfa() {
    // Verifica si hay usuario autenticado
    if (!auth.currentUser) {
        speak("Debes iniciar sesi√≥n para usar Alfa.");
        return;
    }
    try {
        const userRef = doc(db, "users", auth.currentUser.uid);
        const userDoc = await getDoc(userRef);
        if (userDoc.exists()) {
            currentUserName = userDoc.data().nombre;
            speak(`Hola ${currentUserName}, soy Alfa. Estoy listo para ayudarte.`);
        } else {
            speak("No se encontraron datos del usuario.");
        }
    } catch (error) {
        console.error("Error al obtener datos del usuario:", error);
        speak("Hubo un error al obtener tus datos.");
    }
    recognition.start();
}

/***********************************************
 * EVENTOS DE RECONOCIMIENTO DE VOZ
 ***********************************************/
recognition.onresult = (event) => {
    if (isSpeaking) return; // Evitar solapamientos si Alfa est√° hablando
    const command = event.results[0][0].transcript.toLowerCase();
    console.log("Comando recibido:", command);
    
    if (activationListening && command.includes('oye alfa')) {
        activationListening = false;
        listening = true;
        speak(`Dime, ${currentUserName}.`);
    } else if (awaitingSearchQuery) {
        awaitingSearchQuery = false;
        performCustomSearch(command);
    } else if (awaitingVisitResponse) {
        handleVisitResponse(command);
    } else if (awaitingFileQuery) {
        awaitingFileQuery = false;
        handleFileSearch(command);
    } else if (listening) {
        handleCommand(command);
    }
};

recognition.onend = () => {
    // Si a√∫n estamos en modo de escucha o activaci√≥n, reiniciar el reconocimiento
    if (listening || activationListening) recognition.start();
};

recognition.onstart = () => {
    console.log("Alfa est√° escuchando.");
};

recognition.onerror = (event) => {
    console.error("Error en reconocimiento de voz:", event.error);
    recognition.start();
};

/***********************************************
 * MANEJO DE COMANDOS DE VOZ
 ***********************************************/

/**
 * Procesa el comando recibido y redirige a la funci√≥n correspondiente.
 * @param {string} command Comando de voz.
 */
function handleCommand(command) {
    if (command.includes('abrir pesta√±a')) {
        handleTabCommand(command);
    } else if (command.includes('dime las entregas de la semana')) {
        handleDeliveriesCommand();
    } else if (command.includes('cerrar sesi√≥n')) {
        handleLogoutCommand();
    } else if (command.includes('sube un archivo')) {
        // Si a√∫n no tienes implementada esta funcionalidad, se incluye un placeholder.
        handleUploadCommand(command);
    } else if (command.includes('dime la pol√≠tica de calidad') || command.includes('dime la pol√≠tica de inocuidad')) {
        handleQualityPolicyCommand();
    } else if (command.includes('realiza una b√∫squeda')) {
        speak("¬øQu√© deseas buscar en internet?");
        awaitingSearchQuery = true;
    } else if (command.includes('realiza un c√°lculo') || command.includes('calcula')) {
        handleMathCommand(command);
    } else if (command.includes('explica la plataforma')) {
        handleExplainPlatformCommand();
    } else if (command.includes('abrir requisito')) {
        handleRequirementCommand(command); // NUEVA FUNCI√ìN PARA ABRIR REQUISITOS

    } else if (command.includes('generar factura')) {
        handleInvoiceCommand(command);
    } else if (command.includes('abrir archivo')) {
        speak("Por favor, dime el nombre del archivo diciendo 'archivo [nombre del archivo]'.");
        awaitingFileQuery = true;
    } else if (command.includes('ya es todo alfa') || command.includes('gracias alfa')) {
        listening = false;
        activationListening = true;
        speak("Estoy a tus √≥rdenes.");
    } else {
        speak(`Lo siento ${currentUserName}, no entend√≠ tu solicitud.`);
    }
}

/**
 * Maneja la b√∫squeda y apertura de archivos.
 * @param {string} command Comando de voz.
 */
async function handleFileSearch(command) {
    const fileMatch = command.match(/archivo\s+(.*)/);
    if (!fileMatch) {
        speak("Por favor, aseg√∫rate de decir 'archivo' seguido del nombre del archivo.");
        return;
    }
    const partialFileName = fileMatch[1].trim().toLowerCase();
    try {
        const querySnapshot = await getDocs(collection(db, "files"));
        const matchingFiles = [];
        querySnapshot.forEach(docSnap => {
            const file = docSnap.data();
            if (file.name.toLowerCase().includes(partialFileName)) {
                matchingFiles.push(file);
            }
        });
        if (matchingFiles.length === 0) {
            speak(`No encontr√© ning√∫n archivo que coincida con el nombre proporcionado: ${partialFileName}.`);
        } else if (matchingFiles.length === 1) {
            const file = matchingFiles[0];
            window.open(file.url, '_blank');
            speak(`Abriendo el archivo: ${file.name}.`);
        } else {
            const fileList = matchingFiles.map(file => file.name).join(', ');
            speak(`Encontr√© varios archivos con nombres similares: ${fileList}. Por favor, dime el nombre completo del archivo para abrir.`);
        }
    } catch (error) {
        console.error("Error al buscar el archivo:", error);
        speak("Hubo un problema al buscar el archivo. Por favor, intenta nuevamente.");
    }
}

/**
 * Realiza una b√∫squeda personalizada usando la API de Google Custom Search.
 * @param {string} query Consulta de b√∫squeda.
 */
async function performCustomSearch(query) {
    try {
        const response = await fetch(`https://www.googleapis.com/customsearch/v1?q=${encodeURIComponent(query)}&key=${GOOGLE_API_KEY}&cx=${SEARCH_ENGINE_ID}`);
        const data = await response.json();
        if (data.items && data.items.length > 0) {
            const firstResult = data.items[0];
            pendingLink = firstResult.link;
            speak(`Encontr√© lo siguiente: ${firstResult.title}. ${firstResult.snippet}. ¬øQuieres visitar el enlace?`);
            awaitingVisitResponse = true;
        } else {
            speak("No encontr√© resultados relevantes. Por favor, intenta con otra b√∫squeda.");
        }
    } catch (error) {
        console.error("Error al realizar la b√∫squeda en internet:", error);
        speak("Hubo un problema al realizar la b√∫squeda. Por favor, intenta nuevamente.");
    }
}

/**
 * Maneja la respuesta del usuario para visitar un enlace encontrado.
 * @param {string} command Respuesta del usuario.
 */
function handleVisitResponse(command) {
    if (command.includes('s√≠') || command.includes('claro') || command.includes('por supuesto')) {
        window.open(pendingLink, '_blank');
        speak("Abriendo el enlace. Estoy a tus √≥rdenes para cualquier otra solicitud.");
    } else if (command.includes('no')) {
        speak("Entendido. Estoy pendiente de tu siguiente solicitud.");
    } else {
        speak("No entend√≠ tu respuesta. ¬øQuieres visitar el enlace?");
        return; // Se espera una respuesta v√°lida
    }
    awaitingVisitResponse = false;
    pendingLink = "";
}

/**
 * Maneja la apertura de pesta√±as seg√∫n el comando de voz.
 * @param {string} command Comando de voz.
 */
function handleTabCommand(command) {
    const tabs = {
        'listas': 'lists',
        'formatos': 'files',
        'requisitos': 'requisitos',
        'inicio': 'home',
        'mapa': 'content-mapa',
        'procedimientos': 'procedimientos',
        'inocuidad': 'inocuidad'
    };
    for (const [key, tabId] of Object.entries(tabs)) {
        if (command.includes(key)) {
            showTabContent(tabId);
            speak(`Abriendo la pesta√±a de ${key}.`);
            return;
        }
    }
    speak(`Lo siento ${currentUserName}, no encontr√© esa pesta√±a.`);
}

/**
 * Placeholder para la funcionalidad de subir archivos.
 * (Implementa seg√∫n tus necesidades)
 * @param {string} command Comando de voz.
 */
function handleUploadCommand(command) {
    // Aqu√≠ puedes integrar la l√≥gica para subir archivos.
    speak("La funcionalidad para subir archivos a√∫n no est√° implementada.");
}

/**
 * Maneja el cierre de sesi√≥n.
 */
function handleLogoutCommand() {
    auth.signOut()
        .then(() => {
            speak("Sesi√≥n cerrada con √©xito. Hasta pronto.");
            setTimeout(() => {
                // Redirigir o mostrar la pantalla de registro y/o pol√≠tica de calidad
                document.getElementById('menu-screen').style.display = 'none';
                document.getElementById('register-screen').style.display = 'block';
                document.getElementById('info-container').style.display = 'block';
            }, 2000);
        })
        .catch(error => {
            console.error("Error al cerrar sesi√≥n:", error);
            speak("Hubo un error al cerrar la sesi√≥n. Por favor, int√©ntalo nuevamente.");
        });
}

/**
 * Lee y comunica la pol√≠tica de calidad e inocuidad.
 */
function handleQualityPolicyCommand() {
    const policyText = `En Aceites y L√≠pidos BD nos comprometemos a: Proveer aceites y mantecas comestibles, desarrollando y adecuando las formulaciones de nuevos productos, cumpliendo con las regulaciones nacionales e internacionales. Contar con personal competente, gestionando los impactos del cambio clim√°tico en nuestros procesos y resultados, comunicando de manera efectiva con todas las partes interesadas para satisfacer sus necesidades y expectativas. Lograr la mejora continua otorgando asesor√≠a para el manejo de nuestra gama de productos y desarrollos, aplicando nuestros productos en la elaboraci√≥n de productos de nuestros clientes, generando una total confianza y satisfacci√≥n plena en nuestros clientes.`;
    speak("Leyendo la pol√≠tica de calidad e inocuidad.");
    speak(policyText);
}

/**
 * Maneja operaciones matem√°ticas, incluyendo c√°lculos de inter√©s simple y compuesto.
 * @param {string} command Comando de voz.
 */
function handleMathCommand(command) {
    try {
        let mathExpression;
        if (command.includes('inter√©s simple')) {
            const match = command.match(/(\d+(?:\.\d+)?)\s*por ciento de\s*(\d+(?:\.\d+)?)\s*por\s*(\d+)\s*a√±os?/);
            if (match) {
                const rate = parseFloat(match[1]) / 100;
                const principal = parseFloat(match[2]);
                const time = parseInt(match[3]);
                const interest = principal * rate * time;
                speak(`El inter√©s simple es ${interest.toFixed(2)}`);
                return;
            } else {
                speak('Por favor, proporciona una tasa de inter√©s, un monto y un per√≠odo de tiempo.');
                return;
            }
        } else if (command.includes('inter√©s compuesto')) {
            const match = command.match(/(\d+(?:\.\d+)?)\s*por ciento de\s*(\d+(?:\.\d+)?)\s*por\s*(\d+)\s*a√±os?/);
            if (match) {
                const rate = parseFloat(match[1]) / 100;
                const principal = parseFloat(match[2]);
                const time = parseInt(match[3]);
                const amount = principal * Math.pow((1 + rate), time);
                const interest = amount - principal;
                speak(`El inter√©s compuesto es ${interest.toFixed(2)}`);
                return;
            } else {
                speak('Por favor, proporciona una tasa de inter√©s, un monto y un per√≠odo de tiempo.');
                return;
            }
        } else {
            mathExpression = command.replace(/realiza un c√°lculo|calcula|suma|resta|multiplica|divide/g, '').trim();
            mathExpression = mathExpression.replace(/por/g, '*').replace(/entre/g, '/');
            if (!mathExpression.length) {
                speak('Por favor, dime qu√© operaci√≥n matem√°tica deseas realizar.');
                return;
            }
            const result = eval(mathExpression);
            if (!isNaN(result)) {
                speak(`El resultado es ${result}`);
            } else {
                speak('Lo siento, no pude realizar el c√°lculo.');
            }
        }
    } catch (error) {
        speak('Hubo un error al realizar el c√°lculo.');
    }
}

/**
 * Explica el funcionamiento de la plataforma.
 */
function handleExplainPlatformCommand() {
    const explanation = `Esta plataforma est√° dise√±ada para gestionar documentos relacionados con las normas ISO, como ISO 9001 e ISO 22000. Puedes navegar entre pesta√±as, subir documentos y consultar informaci√≥n clave de calidad e inocuidad.`;
    speak(explanation);
}

/**
 * Maneja la generaci√≥n de facturas.
 * @param {string} command Comando de voz.
 */
async function handleInvoiceCommand(command) {
    const match = command.match(/generar factura para (.+) por (\d+)/);
    if (!match) {
        speak("Por favor, indica el nombre del cliente y el monto, por ejemplo: 'Generar factura para Juan P√©rez por 5000 pesos'.");
        return;
    }
    const cliente = match[1].trim();
    const monto = match[2].trim();
    speak(`Generando factura para ${cliente} por ${monto} pesos.`);
    const invoiceData = {
        cliente,
        monto,
        fecha: new Date().toLocaleDateString("es-ES"),
        descripcion: "Venta de productos y servicios.",
        numeroFactura: Math.floor(Math.random() * 1000000)
    };
    generateInvoicePDF(invoiceData);
}

/**
 * Genera un PDF de factura utilizando jsPDF.
 * @param {object} data Datos de la factura.
 */
function generateInvoicePDF(data) {
    if (!window.jspdf || !window.jspdf.jsPDF) {
        speak("Error: jsPDF no est√° disponible. Verifica la conexi√≥n con la librer√≠a.");
        console.error("Error: jsPDF no est√° disponible.");
        return;
    }
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    const logoUrl = "https://yourcompany.com/logo.png"; // Aseg√∫rate de tener un logo v√°lido
    const img = new Image();
    img.src = logoUrl;
    
    img.onload = () => {
        doc.addImage(img, "PNG", 140, 10, 50, 20);
        drawInvoiceContent(doc, data);
        const fileName = `Factura_${data.numeroFactura}.pdf`;
        doc.save(fileName);
        speak("Factura generada con √©xito. Puedes encontrarla en tus descargas.");
    };
    
    img.onerror = () => {
        speak("No se pudo cargar el logo, pero la factura se generar√° sin √©l.");
        drawInvoiceContent(doc, data);
        const fileName = `Factura_${data.numeroFactura}.pdf`;
        doc.save(fileName);
        speak("Factura generada con √©xito. Puedes encontrarla en tus descargas.");
    };
}

/**
 * Dibuja el contenido de la factura en el documento jsPDF.
 * @param {object} doc Instancia de jsPDF.
 * @param {object} data Datos de la factura.
 */
function drawInvoiceContent(doc, data) {
    doc.setFont("helvetica", "bold");
    doc.setFontSize(20);
    doc.text("FACTURA", 20, 20);
    doc.setLineWidth(0.5);
    doc.line(20, 25, 190, 25);
    
    doc.setFontSize(12);
    doc.setFont("helvetica", "normal");
    doc.text("Aceites y L√≠pidos BD", 20, 35);
    doc.text("Calle Principal #123, Ciudad", 20, 45);
    doc.text("Tel√©fono: +52 123 456 7890", 20, 55);
    doc.text("Correo: contacto@empresa.com", 20, 65);
    
    doc.setFont("helvetica", "bold");
    doc.text("N√∫mero de Factura:", 20, 80);
    doc.setFont("helvetica", "normal");
    doc.text(`${data.numeroFactura}`, 70, 80);
    
    doc.setFont("helvetica", "bold");
    doc.text("Cliente:", 20, 90);
    doc.setFont("helvetica", "normal");
    doc.text(`${data.cliente}`, 70, 90);
    
    doc.setFont("helvetica", "bold");
    doc.text("Fecha:", 20, 100);
    doc.setFont("helvetica", "normal");
    doc.text(`${data.fecha}`, 70, 100);
    
    doc.setFont("helvetica", "bold");
    doc.text("Monto:", 20, 110);
    doc.setFont("helvetica", "normal");
    doc.text(`$${data.monto} MXN`, 70, 110);
    
    doc.setFont("helvetica", "bold");
    doc.text("Descripci√≥n:", 20, 120);
    doc.setFont("helvetica", "normal");
    doc.text(`${data.descripcion}`, 70, 120);
    
    doc.line(20, 130, 190, 130);
    doc.setFontSize(10);
    doc.setFont("helvetica", "italic");
    doc.text("Esta factura es v√°lida conforme a las normativas fiscales de M√©xico.", 20, 140);
}

/**
 * Obtiene y comunica todas las entregas programadas para la semana.
 */
async function handleDeliveriesCommand() {
    try {
        const today = new Date();
        const weekDays = ["domingo", "lunes", "martes", "mi√©rcoles", "jueves", "viernes", "s√°bado", "pendiente"];
        console.log("üìå D√≠a actual:", weekDays[today.getDay()]);
        
        const deliveriesRef = collection(db, "entregas");
        const querySnapshot = await getDocs(deliveriesRef);
        const deliveries = {};
        let found = false;
        
        console.log("üìå üîç Entregas obtenidas desde Firestore:");
        querySnapshot.forEach(docSnap => {
            const data = docSnap.data();
            console.log(data);
            if (!data.dia || !data.cliente || !data.cantidad || !data.producto || !data.lote) {
                console.warn("‚ö†Ô∏è Documento con datos faltantes:", docSnap.id, data);
                return;
            }
            const dia = data.dia.toLowerCase().trim();
            if (!weekDays.includes(dia)) {
                console.warn("‚ö†Ô∏è D√≠a inv√°lido en Firestore:", data.dia, "- Documento ignorado.");
                return;
            }
            if (!deliveries[dia]) deliveries[dia] = [];
            deliveries[dia].push(data);
        });
        
        console.log("üìå ‚úÖ Entregas organizadas por d√≠a:", deliveries);
        let response = "Aqu√≠ est√°n todas las entregas programadas para esta semana:";
        weekDays.forEach(day => {
            if (deliveries[day] && deliveries[day].length > 0) {
                found = true;
                response += ` El ${day}: `;
                deliveries[day].forEach(entrega => {
                    response += `Entrega a ${entrega.cliente}, ${entrega.cantidad} unidades de ${entrega.producto}, lote ${entrega.lote}. `;
                });
            }
        });
        
        if (!found) {
            speak("No hay entregas programadas para esta semana.");
        } else {
            console.log("üìå ‚úÖ Alfa dir√°:", response);
            speak(response);
        }
    } catch (error) {
        console.error("Error al obtener entregas:", error);
        speak("Hubo un problema al obtener las entregas de la semana. Intenta de nuevo m√°s tarde.");
    }
}

//REQUIAITOS
function handleRequirementCommand(command) {
    const requisito = command.match(/\d+(\.\d+)*$/); // Extrae el n√∫mero del requisito solicitado

    if (command.includes('todos')) {
        abrirTodosLosRequisitos(); // Expande todos los requisitos desde 4.0 hasta 10.0
    } else if (requisito) {
        abrirRequisitoEspecifico(requisito[0]); // Abre el requisito espec√≠fico solicitado
    } else {
        speak("No encontr√© el requisito solicitado. Intenta decir 'abrir requisito 5.2.1' por ejemplo.");
    }
}

// üîπ Funci√≥n para abrir TODOS los requisitos y subm√≥dulos
function abrirTodosLosRequisitos() {
    document.querySelectorAll('.submenu').forEach(submenu => {
        submenu.style.display = 'block'; // Expande todos los submen√∫s
    });

    document.querySelectorAll('button[onclick^="mostrarDetalle"]').forEach(button => {
        const requisitoId = button.getAttribute('onclick').match(/'(\d+(\.\d+)*)'/);
        if (requisitoId) {
            mostrarDetalle(requisitoId[1]); // Muestra cada requisito en detalle
        }
    });

    speak("Todos los requisitos han sido abiertos.");
}

// üîπ Funci√≥n para abrir un REQUISITO ESPEC√çFICO
function abrirRequisitoEspecifico(requisitoId) {
    const button = document.querySelector(`button[onclick="mostrarDetalle('${requisitoId}')"]`);

    if (button) {
        button.click(); // Simula el clic en el bot√≥n correspondiente
        speak(`Abriendo el requisito ${requisitoId}.`);
    } else {
        speak(`No encontr√© el requisito ${requisitoId}. Intenta con otro n√∫mero.`);
    }
}








/***********************************************
 * EVENTO DE ACTIVACI√ìN DE ALFA
 ***********************************************/
alfaAssistant.addEventListener('click', () => {
    listening = true;
    initializeAlfa();
});





// MAPA DE PROCESOS - C√≥digo actualizado para centrar la visualizaci√≥n

// MAPA DE PROCESOS - Mostrar solo cuando se est√° en la pesta√±a espec√≠fica
document.addEventListener('DOMContentLoaded', () => {
    const tabs = document.querySelectorAll('.tabs div');
    const contentMapa = document.getElementById('content-mapa');
    const imgMapaProcesos = document.getElementById('mapa-procesos-img');

    if (!contentMapa || !imgMapaProcesos) {
        console.error("No se encontraron los elementos necesarios para el mapa de procesos.");
        return;
    }

    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            // Ocultar el contenido del mapa al cambiar de pesta√±a
            if (tab.id !== 'tab-mapa') {
                contentMapa.style.display = 'none';
                imgMapaProcesos.src = ''; // Limpiar la imagen
            } else {
                // Mostrar el contenido del mapa al entrar en la pesta√±a "Mapa de Procesos"
                contentMapa.style.display = 'flex';
                contentMapa.style.flexDirection = 'column';
                contentMapa.style.justifyContent = 'center';
                contentMapa.style.alignItems = 'center';
                contentMapa.style.height = '100vh';
                contentMapa.style.backgroundColor = '#f8f8f8';

                // Cargar la imagen desde Firebase Storage
                const storage = getStorage();
                const imageRef = ref(storage, 'Imagen de WhatsApp 2024-12-11 a las 19.25.14_8d4d0dbe.jpg');

                getDownloadURL(imageRef)
                    .then((url) => {
                        imgMapaProcesos.src = url;
                        imgMapaProcesos.style.maxWidth = '90%';
                        imgMapaProcesos.style.height = 'auto';
                        imgMapaProcesos.style.border = '2px solid #ddd';
                        imgMapaProcesos.style.boxShadow = '0 4px 8px rgba(0, 0, 0, 0.1)';
                    })
                    .catch((error) => {
                        console.error('Error al cargar la imagen:', error);
                        imgMapaProcesos.alt = 'Error al cargar el mapa de procesos.';
                    });
            }
        });
    });
});




// Variables globales
let pdfDocument = null; // Documento PDF cargado
let currentPage = 1; // P√°gina actual
let currentMatches = []; // Coincidencias actuales
let currentMatchIndex = -1; // √çndice de la coincidencia actual
const pdfViewerContainer = document.getElementById("pdfViewerContainer");



//FUN CION PARA PESTA√ëA DE DOCUMENTOS 
// Variables para la paginaci√≥n
let currentPageFiles = 1;
let currentPageLists = 1;
const itemsPerPage = 12;

// Funci√≥n para cargar los archivos con paginaci√≥n
async function loadFilesPaginated() {
    const fileTableBody = document.getElementById("fileTableBody");
    const paginationContainer = document.getElementById("pagination-container-files");
    fileTableBody.innerHTML = "";
    paginationContainer.innerHTML = "";

    // Obtener todos los archivos desde Firestore
    const querySnapshot = await getDocs(collection(db, "files"));
    const files = [];
    querySnapshot.forEach((doc) => {
        files.push(doc.data());
    });

    // Ordenar los archivos por nombre para consistencia
    files.sort((a, b) => a.name.localeCompare(b.name));

    // Calcular el n√∫mero total de p√°ginas
    const totalPages = Math.ceil(files.length / itemsPerPage);

    // Validar que la p√°gina actual no exceda el total de p√°ginas
    if (currentPageFiles > totalPages) {
        currentPageFiles = totalPages;
    }

    // Obtener los archivos de la p√°gina actual
    const start = (currentPageFiles - 1) * itemsPerPage;
    const end = start + itemsPerPage;
    const currentFiles = files.slice(start, end);

    // Mostrar los archivos en la tabla
    currentFiles.forEach((fileData) => {
        const row = document.createElement("tr");

        const titleCell = document.createElement("td");
        titleCell.textContent = fileData.name;

        const codeCell = document.createElement("td");
        codeCell.textContent = fileData.code || "C√≥digo no encontrado";

        const fileCell = document.createElement("td");
        if (fileData.url) {
            const link = document.createElement("a");
            link.href = fileData.url;
            link.target = "_blank";
            link.classList.add("file-link");
            link.innerHTML = `<img src="https://img.icons8.com/ios-filled/50/000000/pdf.png" class="icon" /> Ver archivo`;
            fileCell.appendChild(link);
        } else {
            fileCell.textContent = "Sin Archivo";
            fileCell.classList.add("no-file");
        }

        row.appendChild(titleCell);
        row.appendChild(codeCell);
        row.appendChild(fileCell);
        fileTableBody.appendChild(row);
    });

    // Crear botones de paginaci√≥n
    for (let i = 1; i <= totalPages; i++) {
        const button = document.createElement("button");
        button.textContent = i;
        button.classList.add("pagination-button");
        if (i === currentPageFiles) button.classList.add("active");
        button.addEventListener("click", () => {
            currentPageFiles = i;
            loadFilesPaginated();
        });
        paginationContainer.appendChild(button);
    }
}



// ------- Normalizador/ordenador de c√≥digos -------
function parseCode(code) {
  if (!code) return [Number.MAX_SAFE_INTEGER, 0, 0, 0];

  const up = String(code).toUpperCase().trim();
  if (up.includes('N/A') || up.includes('NO APLICA')) {
    return [Number.MAX_SAFE_INTEGER, 0, 0, 0]; // al final
  }

  // Peso por prefijo
  const weights = { REG:100, PRO:200, ITO:300, VID:400, ISO:500, SGC:600 };
  const m = up.match(/^(REG|PRO|ITO|VID|ISO|SGC)/);
  const prefix = m ? m[1] : 'ZZZ';
  const prefixWeight = weights[prefix] ?? 999; // desconocidos al final

  // Quitar prefijo y separadores tipo REG.: REG- REG:
  const cleaned = up.replace(/^(REG|PRO|ITO|VID|ISO|SGC)\s*[:.\-]?\s*/,'').trim();

  // Tomar grupos num√©ricos seguros (soporta "8510-02", " 8510 - 02", etc.)
  const parts = cleaned.split('-').map(s => parseInt(s.replace(/\D/g,''), 10) || 0);
  while (parts.length < 3) parts.push(0);

  return [prefixWeight, parts[0], parts[1], parts[2]];
}

// ------- Cargar + ordenar + paginar -------
async function loadListsPaginated(type) {
  const fileTableBody = document.getElementById("fileTableBody-lists");
  const paginationContainer = document.getElementById("pagination-container-files");
  fileTableBody.innerHTML = "";
  paginationContainer.innerHTML = "";

  // Lee la colecci√≥n de la pesta√±a elegida
  const snap = await getDocs(collection(db, `files-${type}`));
  const files = snap.docs.map(d => d.data()); // <-- siempre array

  // Ordenar SIEMPRE
  files.sort((a, b) => {
    const A = parseCode(a.code);
    const B = parseCode(b.code);
    for (let i = 0; i < A.length; i++) {
      if (A[i] !== B[i]) return A[i] - B[i];
    }
    // si c√≥digo igual, desempata por t√≠tulo
    return String(a.name || '').localeCompare(String(b.name || ''));
  });

  // Paginaci√≥n
  const totalPages = Math.max(1, Math.ceil(files.length / itemsPerPage));
  if (currentPageLists > totalPages) currentPageLists = totalPages;

  const start = (currentPageLists - 1) * itemsPerPage;
  const end = start + itemsPerPage;
  const currentFiles = files.slice(start, end);

  currentFiles.forEach(fileData => {
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${fileData.name || ''}</td>
      <td>${fileData.code || 'C√≥digo no encontrado'}</td>
      <td>${
        fileData.url
          ? `<a href="${fileData.url}" target="_blank">
               <img src="https://img.icons8.com/ios-filled/50/000000/pdf.png" class="icon"/> Ver archivo
             </a>`
          : 'Sin Archivo'
      }</td>
    `;
    fileTableBody.appendChild(row);
  });

  // Botones de paginaci√≥n
  for (let i = 1; i <= totalPages; i++) {
    const btn = document.createElement("button");
    btn.textContent = i;
    btn.classList.add("pagination-button");
    if (i === currentPageLists) btn.classList.add("active");
    btn.addEventListener("click", () => { currentPageLists = i; loadListsPaginated(type); });
    paginationContainer.appendChild(btn);
  }
}

// ------- Navegaci√≥n del men√∫ (sin onclick) -------
document.addEventListener('DOMContentLoaded', () => {
  const menu = document.getElementById('listsDropdownMenu');

  menu.addEventListener('click', (e) => {
    const a = e.target.closest('a[data-type]');
    if (!a) return;
    e.preventDefault();

    // activar visualmente
    menu.querySelectorAll('a').forEach(x => x.classList.remove('active'));
    a.classList.add('active');

    // cargar ordenado
    currentPageLists = 1;
    loadListsPaginated(a.dataset.type);
  });

  // pesta√±a por defecto (marcar activa + cargar)
  const def = menu.querySelector('a[data-type="SGC"]') || menu.querySelector('a[data-type]');
  if (def) {
    def.classList.add('active');
    loadListsPaginated(def.dataset.type);
  }
});




// Archivos de PDF en Firebase Storage
const pdfFiles = {
    iso9001: "normas/NORMA_ISO_9001-2015_Req.PDF",
    iso22000: "normas/ISO-22000-2018.pdf",
};

// Obtener la URL del PDF desde Firebase Storage
async function getPdfUrl(filePath) {
    const fileRef = ref(storage, filePath);
    try {
        const url = await getDownloadURL(fileRef);
        return url;
    } catch (error) {
        console.error(`Error al obtener la URL de ${filePath}:`, error);
        alert("No se pudo cargar el archivo PDF. Intenta de nuevo m√°s tarde.");
        return null;
    }
}

// Renderizar una p√°gina en un canvas
async function renderPage(pageNumber, searchTerm = null) {
    const page = await pdfDocument.getPage(pageNumber);
    const viewport = page.getViewport({ scale: 1.5 });

    // Crear canvas para la p√°gina
    const canvas = document.createElement("canvas");
    const context = canvas.getContext("2d");
    canvas.width = viewport.width;
    canvas.height = viewport.height;
    canvas.style.marginBottom = "20px";

    // Renderizar el PDF en el canvas
    const renderContext = {
        canvasContext: context,
        viewport: viewport,
    };
    await page.render(renderContext).promise;

    // Agregar el canvas al contenedor
    pdfViewerContainer.appendChild(canvas);

    // Si hay un t√©rmino de b√∫squeda, subrayar coincidencias
    if (searchTerm) {
        return underlineFullWords(page, viewport, searchTerm, context, pageNumber);
    }

    return [];
}

// Subrayar texto coincidente en la p√°gina
async function underlineFullWords(page, viewport, searchTerm, context, pageNumber) {
    const textContent = await page.getTextContent();
    const scale = viewport.scale;
    const matches = [];

    textContent.items.forEach((item) => {
        const text = item.str;

        if (text.toLowerCase().includes(searchTerm.toLowerCase())) {
            // Posici√≥n y dimensiones del texto
            const transform = item.transform;
            const x = transform[4]; // Posici√≥n X
            const y = transform[5]; // Posici√≥n Y
            const width = context.measureText(text).width * scale; // Ancho de la palabra completa
            const height = item.height * scale; // Altura de la palabra

            // Dibujar un rect√°ngulo amarillo debajo de la palabra coincidente
            context.fillStyle = "rgba(255, 255, 0, 0.6)";
            context.fillRect(x * scale, viewport.height - y * scale - height, width, height);

            // Guardar la posici√≥n de la coincidencia
            matches.push({ page: pageNumber, x: x * scale, y: viewport.height - y * scale, width, height });
        }
    });

    return matches;
}

// Cargar el PDF y renderizar sus p√°ginas
async function loadPdfAndInitializeViewer(norma) {
    const filePath = pdfFiles[norma];
    if (filePath) {
        const pdfUrl = await getPdfUrl(filePath);
        if (pdfUrl) {
            pdfViewerContainer.innerHTML = ""; // Limpiar contenedor
            pdfDocument = await pdfjsLib.getDocument(pdfUrl).promise;

            // Renderizar todas las p√°ginas
            for (let i = 1; i <= pdfDocument.numPages; i++) {
                await renderPage(i);
            }
           
        } else {
            alert("Error al cargar el archivo seleccionado.");
        }
    } else {
        alert("No se encontr√≥ el archivo para la norma seleccionada.");
    }
}

// Ejecutar la b√∫squeda y subrayar las coincidencias
const searchButton = document.getElementById("searchButton");
const searchInput = document.getElementById("searchInput");
const prevMatchButton = document.getElementById("prevMatchButton");
const nextMatchButton = document.getElementById("nextMatchButton");

searchButton.addEventListener("click", async () => {
    const searchTerm = searchInput.value.trim();
    if (!searchTerm) {
        alert("Ingresa una palabra para buscar.");
        return;
    }

    if (!pdfDocument) {
        alert("Primero debes cargar un documento.");
        return;
    }

    // Volver a renderizar las p√°ginas con subrayado y obtener coincidencias
    pdfViewerContainer.innerHTML = ""; // Limpiar contenedor
    currentMatches = []; // Reiniciar coincidencias
    for (let i = 1; i <= pdfDocument.numPages; i++) {
        const matches = await renderPage(i, searchTerm);
        currentMatches = currentMatches.concat(matches);
    }

    if (currentMatches.length > 0) {
        alert(`Se encontraron ${currentMatches.length} coincidencias.`);
        currentMatchIndex = 0;
        goToMatch(currentMatchIndex);
    } else {
        alert("No se encontraron coincidencias.");
    }
});

// Navegar a una coincidencia espec√≠fica
function goToMatch(index) {
    const match = currentMatches[index];
    if (!match) return;

    // Cambiar a la p√°gina de la coincidencia
    pdfViewerContainer.innerHTML = ""; // Limpiar contenedor
    renderPage(match.page).then(() => {
        const canvas = pdfViewerContainer.querySelector("canvas");
        const context = canvas.getContext("2d");

        // Resaltar la coincidencia actual
        context.strokeStyle = "red";
        context.lineWidth = 2;
        context.strokeRect(match.x, match.y - match.height, match.width, match.height);
    });
}

// Bot√≥n "Anterior"
prevMatchButton.addEventListener("click", () => {
    if (currentMatches.length === 0) return;
    currentMatchIndex = (currentMatchIndex - 1 + currentMatches.length) % currentMatches.length;
    goToMatch(currentMatchIndex);
});

// Bot√≥n "Siguiente"
nextMatchButton.addEventListener("click", () => {
    if (currentMatches.length === 0) return;
    currentMatchIndex = (currentMatchIndex + 1) % currentMatches.length;
    goToMatch(currentMatchIndex);
});

// Cargar el PDF inicial (por defecto ISO 9001)
loadPdfAndInitializeViewer("iso9001");


// Cambiar PDF seg√∫n la norma seleccionada
if (normasSelector) {
    normasSelector.addEventListener("change", (e) => {
        const norma = e.target.value;
        loadPdfAndInitializeViewer(norma);
    });
}

// Abrir modal de Normas ISO
if (normasIsoButton) {
    normasIsoButton.addEventListener("click", () => {
        pdfModal.style.display = "flex";
        loadPdfAndInitializeViewer("iso9001"); // Cargar ISO 9001 por defecto
    });
}



// Obtener el modal y el bot√≥n de cerrar
const pdfModal = document.getElementById("pdfModal");
const closePdfModal = document.getElementById("closePdfModal");

// Funci√≥n para cerrar el modal
function closeModal() {
    pdfModal.style.display = "none";
}



// Cerrar el modal al hacer clic en la X
closePdfModal.addEventListener("click", closeModal);

// Cerrar el modal al hacer clic fuera del contenido
window.addEventListener("click", (event) => {
    if (event.target === pdfModal) {
        closeModal();
    }
});








        async function loadOrgChartImage() {
            const storageRef = ref(storage, 'organigramamarzo.pdf');
            const url = await getDownloadURL(storageRef);
            document.querySelector("#orgChartModal img").src = url;
        }

        document.getElementById("openOrgChart").addEventListener("click", () => {
            loadOrgChartImage();
            document.getElementById("orgChartModal").style.display = "block";
        });

        document.getElementById("closeOrgChart").addEventListener("click", () => {
            document.getElementById("orgChartModal").style.display = "none";
        });

        window.addEventListener("click", (event) => {
            if (event.target == document.getElementById("orgChartModal")) {
                document.getElementById("orgChartModal").style.display = "none";
            }
        });

        document.getElementById("user-box").addEventListener("click", () => {
            const dropdownMenu = document.getElementById("dropdown-menu");
            dropdownMenu.style.display = dropdownMenu.style.display === "block" ? "none" : "block";
        });

        window.addEventListener("click", (event) => {
            if (!event.target.matches("#user-box")) {
                document.getElementById("dropdown-menu").style.display = "none";
            }
        });

        async function extractCodeFromPDF(file) {
            const fileReader = new FileReader();
            return new Promise((resolve, reject) => {
                fileReader.onload = async function () {
                    const typedarray = new Uint8Array(this.result);
                    const pdf = await pdfjsLib.getDocument(typedarray).promise;
                    let extractedText = '';
                    for (let pageNum = 1; pageNum <= pdf.numPages; pageNum++) {
                        const page = await pdf.getPage(pageNum);
                        const textContent = await page.getTextContent();
                        textContent.items.forEach((item) => {
                            extractedText += item.str + ' ';
                        });
                    }
                    const codeMatch = extractedText.match(/REG-\d{4}-\d{2}/);
                    resolve(codeMatch ? codeMatch[0] : "C√≥digo no encontrado");
                };
                fileReader.onerror = () => reject("Error al leer el PDF");
                fileReader.readAsArrayBuffer(file);
            });
        }














        document.getElementById('registerBtn').addEventListener('click', async () => {
    const nombre = document.getElementById('nombre').value;
    const apellido = document.getElementById('apellido').value;
    const rol = document.getElementById('rol').value;
    const registerEmail = document.getElementById('email').value;
    const registerPassword = document.getElementById('password').value;

    if (!nombre || !apellido || !rol || !registerEmail || !registerPassword) {
        alert('Por favor complete todos los campos.');
        return;
    }

    try {
        const userCredential = await createUserWithEmailAndPassword(auth, registerEmail, registerPassword);
        const user = userCredential.user;

        await setDoc(doc(db, "users", user.uid), {
            nombre: nombre,
            apellido: apellido,
            rol: rol,
            email: registerEmail
        });

        showLoadingScreen();
    } catch (error) {
        if (error.code === 'auth/email-already-in-use') {
            alert("Este correo ya est√° registrado. Intenta iniciar sesi√≥n.");
        } else {
            console.error('Error al registrar usuario:', error.message);
            alert('Error al registrar usuario: ' + error.message);
        }
    }
});

document.getElementById('loginBtn').addEventListener('click', async () => {
    const loginEmail = document.getElementById('loginEmail').value;
    const loginPassword = document.getElementById('loginPassword').value;

    if (!loginEmail || !loginPassword) {
        alert('Por favor ingrese su correo electr√≥nico y contrase√±a.');
        return;
    }

    try {
        const userCredential = await signInWithEmailAndPassword(auth, loginEmail, loginPassword);
        showLoadingScreen();
    } catch (error) {
        if (error.code === 'auth/user-not-found') {
            alert("No se encontr√≥ una cuenta con este correo.");
        } else if (error.code === 'auth/wrong-password') {
            alert("La contrase√±a ingresada es incorrecta.");
        } else {
            console.error('Error al iniciar sesi√≥n:', error.message);
            alert('Error al iniciar sesi√≥n: ' + error.message);
        }
    }
});










        function showLoadingScreen() {
    document.getElementById('register-screen').style.display = 'none';
    document.getElementById('signin-screen').style.display = 'none';
    document.getElementById('info-container').style.display = 'none';
    document.getElementById('loading-screen').style.display = 'flex';

    setTimeout(() => {
        document.getElementById('loading-screen').style.display = 'none';
        document.getElementById('menu-screen').style.display = 'block';
        loadFiles();
    }, 5000);
}

document.getElementById('switchToSignIn').addEventListener('click', () => {
    document.getElementById('register-screen').style.display = 'none';
    document.getElementById('signin-screen').style.display = 'block';
});

document.getElementById('switchToRegister').addEventListener('click', () => {
    document.getElementById('signin-screen').style.display = 'none';
    document.getElementById('register-screen').style.display = 'block';
});

// üîπ Subir archivos al apartado general "files"
document.getElementById('uploadBtn').addEventListener('click', async () => {
    const fileInput = document.getElementById("fileInput");
    const file = fileInput.files[0];

    if (!file) {
        alert("Por favor seleccione un archivo para subir.");
        return;
    }

    const code = await extractCodeFromPDF(file);

    try {
        const fileName = file.name;
        const storageRef = ref(storage, `uploads/files/${fileName}`);
        await uploadBytes(storageRef, file);
        const downloadURL = await getDownloadURL(storageRef);

        await addDoc(collection(db, "files"), {
            name: fileName,
            url: downloadURL,
            code: code,
            date: new Date().toLocaleDateString()
        });

        loadFiles();
        fileInput.value = "";
    } catch (error) {
        console.error("Error al subir el archivo:", error.message);
        alert("Error al subir el archivo: " + error.message);
    }
});

async function loadFiles() {
    const fileTableBody = document.getElementById("fileTableBody");
    fileTableBody.innerHTML = '';
    const querySnapshot = await getDocs(collection(db, "files"));

    querySnapshot.forEach((doc) => {
        const fileData = doc.data();
        const row = document.createElement("tr");

        const titleCell = document.createElement("td");
        titleCell.textContent = fileData.name;

        const codeCell = document.createElement("td");
        codeCell.textContent = fileData.code || "C√≥digo no encontrado";

        const fileCell = document.createElement("td");
        if (fileData.url) {
            const link = document.createElement("a");
            link.href = fileData.url;
            link.target = "_blank";
            link.classList.add("file-link");
            link.innerHTML = `<img src="https://img.icons8.com/ios-filled/50/000000/pdf.png" class="icon" /> Ver archivo`;
            fileCell.appendChild(link);
        } else {
            fileCell.textContent = "Sin Archivo";
            fileCell.classList.add("no-file");
        }

        row.appendChild(titleCell);
        row.appendChild(codeCell);
        row.appendChild(fileCell);
        fileTableBody.appendChild(row);
    });
}

window.showListContent = function(type) {
    const listContent = document.getElementById("list-content");
    listContent.innerHTML = `
        <h3>${getListTitle(type)}</h3>
        <input type="file" id="fileInput-${type}" />
        <button class="button" onclick="uploadListFile('${type}')">Subir archivo</button>
        
        <table>
            <thead>
                <tr>
                    <th>T√≠tulo</th>
                    <th>C√≥digo</th>
                    <th>Archivo</th>
                </tr>
            </thead>
            <tbody id="fileTableBody-${type}">
            </tbody>
        </table>
    `;
    loadListFiles(type);
};

function getListTitle(type) {
    switch (type) {
        case 'documentada': return 'Informaci√≥n Documentada Mantenida';
        case 'externos': return 'Documentos Externos';
        case 'registros': return 'Registros';
        case 'perfil': return 'Perfil Funcional';
        case 'responsabilidades': return 'Responsabilidades';
        case 'SGC': return 'SGC';
        default: return 'Lista';
    }
}

// üîπ Subida din√°mica seg√∫n apartado
window.uploadListFile = async function(type) {
    const fileInput = document.getElementById(`fileInput-${type}`);
    const file = fileInput.files[0];

    if (!file) {
        alert("Por favor seleccione un archivo para subir.");
        return;
    }

    const code = await extractCodeFromPDF(file);

    try {
        const fileName = file.name;
        const storageRef = ref(storage, `uploads/${type}/${fileName}`);
        await uploadBytes(storageRef, file);
        const downloadURL = await getDownloadURL(storageRef);

        await addDoc(collection(db, `files-${type}`), {
            name: fileName,
            url: downloadURL,
            code: code,
            date: new Date().toLocaleDateString()
        });

        loadListFiles(type);
        fileInput.value = "";
    } catch (error) {
        console.error("Error al subir el archivo:", error.message);
        alert("Error al subir el archivo: " + error.message);
    }
};

async function loadListFiles(type) {
    const fileTableBody = document.getElementById(`fileTableBody-${type}`);
    fileTableBody.innerHTML = '';
    const querySnapshot = await getDocs(collection(db, `files-${type}`));

    querySnapshot.forEach((doc) => {
        const fileData = doc.data();
        const row = document.createElement("tr");

        const titleCell = document.createElement("td");
        titleCell.textContent = fileData.name;

        const codeCell = document.createElement("td");
        codeCell.textContent = fileData.code || "C√≥digo no encontrado";

        const fileCell = document.createElement("td");
        if (fileData.url) {
            const link = document.createElement("a");
            link.href = fileData.url;
            link.target = "_blank";
            link.classList.add("file-link");
            link.innerHTML = `<img src="https://img.icons8.com/ios-filled/50/000000/pdf.png" class="icon" /> Ver archivo`;
            fileCell.appendChild(link);
        } else {
            fileCell.textContent = "Sin Archivo";
            fileCell.classList.add("no-file");
        }

        row.appendChild(titleCell);
        row.appendChild(codeCell);
        row.appendChild(fileCell);
        fileTableBody.appendChild(row);
    });
}

document.getElementById('tab-home').addEventListener('click', () => {
    showTabContent('home');
});

document.getElementById('tab-lists').addEventListener('click', () => {
    showTabContent('lists');
});

document.getElementById('tab-files').addEventListener('click', () => {
    showTabContent('files');
});

document.getElementById('tab-requisitos').addEventListener('click', () => {
    showTabContent('requisitos');
});


        loadFiles();

       document.getElementById("logout").addEventListener("click", () => {
    signOut(auth).then(() => {
        alert("Confirma cerrar sesi√≥n.");
        // Cambiar redirecci√≥n a la pantalla de creaci√≥n de cuenta e inicio de sesi√≥n
        document.getElementById('menu-screen').style.display = 'none';
        document.getElementById('signin-screen').style.display = 'block';
         document.getElementById('info-container').style.display = 'block';
    }).catch((error) => {
        console.error("Error al cerrar sesi√≥n:", error);
    });
});






async function loadUserProfile() {
    const user = auth.currentUser;
    if (!user) {
        alert("No se ha iniciado sesi√≥n.");
        return;
    }

    try {
        await user.reload(); // Asegura que los datos sean los m√°s recientes
        const userRef = doc(db, "users", user.uid);
        const userDoc = await getDoc(userRef);

        if (userDoc.exists()) {
            const userData = userDoc.data();
            document.getElementById("userName").textContent = userData.nombre;
            document.getElementById("userLastName").textContent = userData.apellido;
            document.getElementById("userRole").textContent = userData.rol;
            document.getElementById("userEmail").textContent = userData.email;

            document.getElementById("profileModal").style.display = "block";
        } else {
            alert("No se encontraron datos del usuario.");
        }
    } catch (error) {
        console.error("Error al cargar el perfil:", error);
        alert("Hubo un problema al cargar el perfil del usuario.");
    }
}





// Mostrar modal de perfil al hacer clic en "Ver mi perfil"
document.getElementById("viewProfile").addEventListener("click", loadUserProfile);

// Cerrar modal de perfil
document.getElementById("closeProfile").addEventListener("click", () => {
    document.getElementById("profileModal").style.display = "none";
});

// Cerrar modal al hacer clic fuera de √©l
window.addEventListener("click", (event) => {
    if (event.target == document.getElementById("profileModal")) {
        document.getElementById("profileModal").style.display = "none";
    }
});
   // Funcionalidad para el men√∫ de tres puntos
     document.addEventListener("DOMContentLoaded", () => {
    const threeDotsMenu = document.getElementById("threeDotsMenu");
    const threeDotsDropdown = document.getElementById("threeDotsDropdown");

    // Mostrar/ocultar el men√∫ de tres puntos
    threeDotsMenu.addEventListener("click", (event) => {
        event.stopPropagation();
        const isVisible = threeDotsDropdown.style.display === "block";
        threeDotsDropdown.style.display = isVisible ? "none" : "block";
    });

    // Cerrar el men√∫ al hacer clic fuera
    window.addEventListener("click", () => {
        if (threeDotsDropdown.style.display === "block") {
            threeDotsDropdown.style.display = "none";
        }
    });

    // Funci√≥n para abrir un modal
    const createModal = (title, content) => {
        const modal = `
            <div class="modal" id="dynamicModal" style="display: flex;">
                <div class="modal-content">
                    <span class="close" id="closeModal">&times;</span>
                    <h2>${title}</h2>
                    <ul>${content}</ul>
                </div>
            </div>
        `;
        document.body.insertAdjacentHTML("beforeend", modal);

        // Cerrar el modal
        document.getElementById("closeModal").addEventListener("click", () => {
            document.getElementById("dynamicModal").remove();
        });

        // Cerrar el modal al hacer clic fuera de √©l
        window.addEventListener("click", (event) => {
            const modalElement = document.getElementById("dynamicModal");
            if (event.target === modalElement) {
                modalElement.remove();
            }
        });
    };

    // Configuraci√≥n para cada enlace del men√∫
    document.getElementById("nonConformities").addEventListener("click", (event) => {
        event.preventDefault();
        createModal("No Conformidades", `
            <li><a href="https://ctalexander.github.io/no-conformidades-/" target="_blank">Ir a No Conformidades</a></li>
        `);
    });

    document.getElementById("directiveDecisions").addEventListener("click", (event) => {
        event.preventDefault();
        createModal("Decisiones Directivas", `
            <li><a href="https://ctalexander.github.io/directive-decisions/" target="_blank">Ir a Decisiones Directivas</a></li>
        `);
    });

    document.getElementById("correctiveActions").addEventListener("click", (event) => {
        event.preventDefault();
        createModal("Acciones Correctivas", `
            <li><a href="https://ctalexander.github.io/corrective-actions/" target="_blank">Ir a Acciones Correctivas</a></li>
        `);
    });

    document.getElementById("otherOptions").addEventListener("click", (event) => {
        event.preventDefault();
        createModal("Otras Opciones", `
            <li><a href="</a></li>
            <li><a href="</a></li>
        `);
    });
});


   //HACCP
   // Manejar el clic del bot√≥n
document.getElementById("btn-haccp").addEventListener("click", () => {
    // Referencia al archivo en Firebase Storage
    const fileRef = ref(storage, "Plan de An√°lisis de Peligros y Puntos Cr√≠ticos de Control (HACCP) OK (5).pdf");

    // Obt√©n la URL de descarga
    getDownloadURL(fileRef)
        .then((url) => {
            // Muestra el contenedor del PDF
            const pdfContainer = document.getElementById("pdf-container");
            pdfContainer.style.display = "block";

            // Establece la URL del PDF en el iframe
            const pdfViewer = document.getElementById("pdf-viewer");
            pdfViewer.src = url;
        })
        .catch((error) => {
            console.error("Error al obtener el archivo:", error);
   });
});


document.getElementById("btn-haccp").addEventListener("click", (event) => {
    event.stopPropagation(); // Previene que el clic cierre el contenedor
    // Resto del c√≥digo para mostrar el PDF

    // Selecciona el contenedor y el bot√≥n
const pdfContainer = document.getElementById("pdf-container");
const pdfViewer = document.getElementById("pdf-viewer");

// Funci√≥n para cerrar el contenedor al hacer clic fuera de √©l
document.addEventListener("click", (event) => {
    // Verifica si el clic ocurri√≥ fuera del contenedor del PDF
    if (
        pdfContainer.style.display === "block" && // Solo si el contenedor est√° visible
        !pdfContainer.contains(event.target) // Si el clic no es dentro del contenedor
    ) {
        pdfContainer.style.display = "none"; // Oculta el contenedor
        pdfViewer.src = ""; // Limpia el contenido del iframe
    }
});

});


// Manejar el clic del bot√≥n Proceso
document.getElementById("btn-proceso").addEventListener("click", () => {
    // Referencia al archivo en Firebase Storage
    const fileRef = ref(storage, "Acciones para abordar riesgos y oportunidades y rev dir (4).pdf");

    // Obt√©n la URL de descarga
    getDownloadURL(fileRef)
        .then((url) => {
            // Muestra el contenedor del PDF
            const pdfContainer = document.getElementById("pdf-container-proceso");
            pdfContainer.style.display = "block";

            // Establece la URL del PDF en el iframe
            const pdfViewer = document.getElementById("pdf-viewer-proceso");
            pdfViewer.src = url;
        })
        .catch((error) => {
            console.error("Error al obtener el archivo:", error);
        });
});

// Manejar clic fuera del contenedor para cerrar el PDF
document.addEventListener("click", (event) => {
    // Selecciona el contenedor y el visor del PDF
    const pdfContainer = document.getElementById("pdf-container-proceso");
    const pdfViewer = document.getElementById("pdf-viewer-proceso");

    // Verifica si el clic ocurri√≥ fuera del contenedor
    if (
        pdfContainer.style.display === "block" && // Solo si el contenedor est√° visible
        !pdfContainer.contains(event.target) // Si el clic no es dentro del contenedor
    ) {
        pdfContainer.style.display = "none"; // Oculta el contenedor
        pdfViewer.src = ""; // Limpia el contenido del iframe
    }
});

document.getElementById("btn-calidad").addEventListener("click", () => {
    // Referencia al archivo en Firebase Storage
    const fileRef = ref(storage, "Manual de Gesti√≥n AyL BD.pdf");

    // Obt√©n la URL de descarga
    getDownloadURL(fileRef)
        .then((url) => {
            // Muestra el contenedor del PDF
            const pdfContainer = document.getElementById("pdf-container-calidad");
            pdfContainer.style.display = "block";

            // Establece la URL del PDF en el iframe
            const pdfViewer = document.getElementById("pdf-viewer-calidad");
            pdfViewer.src = url;
        })
        .catch((error) => {
            console.error("Error al obtener el archivo:", error);
        });
});

// Manejar clic fuera del contenedor para cerrar el PDF
document.addEventListener("click", (event) => {
    const pdfContainer = document.getElementById("pdf-container-calidad");
    const pdfViewer = document.getElementById("pdf-viewer-calidad");

    if (
        pdfContainer.style.display === "block" &&
        !pdfContainer.contains(event.target)
    ) {
        pdfContainer.style.display = "none";
        pdfViewer.src = "";
    }
});










//FUNCION PARA REQUISITOS 
















// Funci√≥n para manejar el contenido de la pesta√±a seleccionada (de 4.0 a 10.0)
function handleRequisitosTab(tabId) {
  const requisitosContent = document.getElementById('requisitos-content');
  if (!requisitosContent) {
    console.error('No se encontr√≥ el contenedor de requisitos.');
    return;
  }

  let html = '';

  switch (tabId) {
    case 'contexto':
      html = `
        <h3>4.0 Contexto</h3>
        <div style="display: flex; gap: 20px; width: 100%;">
            <!-- Lista de puntos para Contexto -->
            <ul style="width: 40%; list-style: none; padding: 0;">
                <li style="margin-bottom: 10px;">
                    <button onclick="mostrarDetalle('4.1')" style="width: 100%; padding: 10px;">
                        4.1 Comprensi√≥n de la organizaci√≥n y su contexto
                    </button>
                </li>
                <li style="margin-bottom: 10px;">
                    <button onclick="mostrarDetalle('4.2')" style="width: 100%; padding: 10px;">
                        4.2 Comprensi√≥n de las necesidades y expectativas de las partes
                    </button>
                </li>
                <li style="margin-bottom: 10px;">
                    <button onclick="mostrarDetalle('4.3')" style="width: 100%; padding: 10px;">
                        4.3 Determinaci√≥n del alcance del SGC
                    </button>
                </li>
                <li>
                    <button onclick="toggleSubMenu('submenu-4.4')" style="width: 100%; padding: 10px;">
                        4.4 SGC y sus procesos ‚ñº
                    </button>
                    <ul id="submenu-4.4" class="submenu" style="display: none; padding-left: 20px; list-style: none;">
                        <li><button onclick="mostrarDetalle('4.4.1')" style="width: 100%; padding: 10px;">4.4.1 Generalidades del SGC</button></li>
                        <li><button onclick="mostrarDetalle('4.4.2')" style="width: 100%; padding: 10px;">4.4.2 Informaci√≥n documentada</button></li>
                    </ul>
                </li>
            </ul>
            <!-- √Årea de detalle -->
            <div id="detalle-requisito" style="width: 60%; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">
                <p>Selecciona un punto para ver el detalle.</p>
            </div>
        </div>
      `;
      break;

    case 'liderazgo':
      html = `
         <h3>5.0 Liderazgo</h3>
        <div style="display: flex; gap: 20px; width: 100%;">
            <!-- Lista de puntos para Liderazgo -->
            <ul style="width: 40%; list-style: none; padding: 0;">
                <li style="margin-bottom: 10px;">
                    <button onclick="toggleSubMenu('submenu-5.1')" style="width: 100%; padding: 10px;">
                        5.1 Liderazgo y compromiso ‚ñº
                    </button>
                    <ul id="submenu-5.1" class="submenu" style="display: none; padding-left: 20px; list-style: none;">
                        <li><button onclick="mostrarDetalle('5.1.1')" style="width: 100%; padding: 10px;">5.1.1 Generalidades</button></li>
                        <li><button onclick="mostrarDetalle('5.1.2')" style="width: 100%; padding: 10px;">5.1.2 Enfoque al Cliente</button></li>
                    </ul>
                </li>
                <li style="margin-bottom: 10px;">
                    <button onclick="toggleSubMenu('submenu-5.2')" style="width: 100%; padding: 10px;">
                        5.2 Pol√≠tica ‚ñº
                    </button>
                    <ul id="submenu-5.2" class="submenu" style="display: none; padding-left: 20px; list-style: none;">
                        <li><button onclick="mostrarDetalle('5.2.1')" style="width: 100%; padding: 10px;">5.2.1 Establecimiento de la pol√≠tica de la calidad</button></li>
                        <li><button onclick="mostrarDetalle('5.2.2')" style="width: 100%; padding: 10px;">5.2.2 Comunicaci√≥n de la pol√≠tica de la calidad</button></li>
                    </ul>
                </li>
                <li style="margin-bottom: 10px;">
                    <button onclick="mostrarDetalle('5.3')" style="width: 100%; padding: 10px;">
                        5.3 Roles, responsabilidades y autoridades organizacionales
                    </button>
                </li>
            </ul>
            <!-- √Årea de detalle -->
            <div id="detalle-requisito" style="width: 60%; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">
                <p>Selecciona un punto para ver el detalle.</p>
            </div>
        </div>
      `;
      break;

    case 'planificacion':
      html = `
        <h3>6.0 Planificaci√≥n</h3>
        <div style="display: flex; gap: 20px; width: 100%;">
            <!-- Lista de puntos para Planificaci√≥n -->
            <ul style="width: 40%; list-style: none; padding: 0;">
                <li style="margin-bottom: 10px;">
                    <button onclick="toggleSubMenu('submenu-6.1')" style="width: 100%; padding: 10px;">
                        6.1 Acciones para abordar riesgos y oportunidades ‚ñº
                    </button>
                    <ul id="submenu-6.1" class="submenu" style="display: none; padding-left: 20px; list-style: none;">
                        <li><button onclick="mostrarDetalle('6.1.1')" style="width: 100%; padding: 10px;">6.1.1 Planificaci√≥n del sistema de gesti√≥n de la calidad</button></li>
                        <li><button onclick="mostrarDetalle('6.1.2')" style="width: 100%; padding: 10px;">6.1.2 Requisitos para planificar oportunidades</button></li>
                    </ul>
                </li>
                <li style="margin-bottom: 10px;">
                    <button onclick="toggleSubMenu('submenu-6.2')" style="width: 100%; padding: 10px;">
                        6.2 Objetivos de la calidad y planificaci√≥n para lograrlos ‚ñº
                    </button>
                    <ul id="submenu-6.2" class="submenu" style="display: none; padding-left: 20px; list-style: none;">
                        <li><button onclick="mostrarDetalle('6.2')" style="width: 100%; padding: 10px;">6.2 Objetivos de la calidad y planificaci√≥n para lograrlos</button></li>
                        <li><button onclick="mostrarDetalle('6.2.1')" style="width: 100%; padding: 10px;">6.2.1 Objetivos de la calidad</button></li>
                        <li><button onclick="mostrarDetalle('6.2.2')" style="width: 100%; padding: 10px;">6.2.2 Planificaci√≥n para lograr los objetivos</button></li>
                    </ul>
                </li>
                <li style="margin-bottom: 10px;">
                    <button onclick="mostrarDetalle('6.3')" style="width: 100%; padding: 10px;">
                        6.3 Planificaci√≥n de los cambios
                    </button>
                </li>
            </ul>
            <!-- √Årea de detalle -->
            <div id="detalle-requisito" style="width: 60%; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">
                <p>Selecciona un punto para ver el detalle.</p>
            </div>
        </div>
      `;
      break;

    case 'apoyo':
      html = `
           <h3>7.0 Apoyo</h3>
            <div style="display: flex; gap: 20px; width: 100%;">
                <!-- Lista de puntos para Apoyo -->
                <ul style="width: 40%; list-style: none; padding: 0;">
                    <li style="margin-bottom: 10px;">
                        <button onclick="toggleSubMenu('submenu-7.1')" style="width: 100%; padding: 10px;">
                            7.1 Recursos ‚ñº
                        </button>
                        <ul id="submenu-7.1" class="submenu" style="display: none; padding-left: 20px; list-style: none;">
                            <li><button onclick="mostrarDetalle('7.1.1')" style="width: 100%; padding: 10px;">7.1.1 Generalidades de Recursos</button></li>
                            <li><button onclick="mostrarDetalle('7.1.2')" style="width: 100%; padding: 10px;">7.1.2 Personas</button></li>
                            <li><button onclick="mostrarDetalle('7.1.3')" style="width: 100%; padding: 10px;">7.1.3 Infraestructura</button></li>
                            <li><button onclick="mostrarDetalle('7.1.4')" style="width: 100%; padding: 10px;">7.1.4 Ambiente para la operaci√≥n de los procesos</button></li>
                            <li>
                                <button onclick="toggleSubMenu('submenu-7.1.5')" style="width: 100%; padding: 10px;">
                                    7.1.5 Recursos de seguimiento y medici√≥n ‚ñº
                                </button>
                                <ul id="submenu-7.1.5" class="submenu" style="display: none; padding-left: 20px; list-style: none;">
                                    <li>
                                        <button onclick="toggleSubMenu('submenu-7.1.5.1')" style="width: 100%; padding: 10px;">
                                            7.1.5.1 Generalidades de Recursos de seguimiento y medici√≥n ‚ñº
                                        </button>
                                        <ul id="submenu-7.1.5.1" class="submenu" style="display: none; padding-left: 20px; list-style: none;">
                                            <li><button onclick="mostrarDetalle('7.1.5.1')" style="width: 100%; padding: 10px;">7.1.5.1 Generalidades</button></li>
                                            <li><button onclick="mostrarDetalle('7.1.5.2')" style="width: 100%; padding: 10px;">7.1.5.2 Trazabilidad de las mediciones</button></li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li><button onclick="mostrarDetalle('7.1.6')" style="width: 100%; padding: 10px;">7.1.6 Conocimientos de la organizaci√≥n</button></li>
                        </ul>
                    </li>

                    <li style="margin-bottom: 10px;">
                        <button onclick="mostrarDetalle('7.2')" style="width: 100%; padding: 10px;">
                            7.2 Competencia
                        </button>
                    </li>
                    <li style="margin-bottom: 10px;">
                        <button onclick="mostrarDetalle('7.3')" style="width: 100%; padding: 10px;">
                            7.3 Toma de conciencia
                        </button>
                    </li>
                    <li style="margin-bottom: 10px;">
                        <button onclick="mostrarDetalle('7.4')" style="width: 100%; padding: 10px;">
                            7.4 Comunicaci√≥n
                        </button>
                    </li>
                    <li style="margin-bottom: 10px;">
                        <button onclick="toggleSubMenu('submenu-7.5')" style="width: 100%; padding: 10px;">
                            7.5 Informaci√≥n documentada ‚ñº
                        </button>
                        <ul id="submenu-7.5" class="submenu" style="display: none; padding-left: 20px; list-style: none;">
                            <li><button onclick="mostrarDetalle('7.5.1')" style="width: 100%; padding: 10px;">7.5.1 Generalidades de informaci√≥n documentada</button></li>
                            <li><button onclick="mostrarDetalle('7.5.2')" style="width: 100%; padding: 10px;">7.5.2 Creaci√≥n y actualizaci√≥n de informaci√≥n documentada</button></li>
                            <li>
                                <button onclick="toggleSubMenu('submenu-7.5.3')" style="width: 100%; padding: 10px;">
                                    7.5.3 Control de la informaci√≥n documentada ‚ñº
                                </button>
                                <ul id="submenu-7.5.3" class="submenu" style="display: none; padding-left: 20px; list-style: none;">
                                    <li><button onclick="mostrarDetalle('7.5.3.1')" style="width: 100%; padding: 10px;">7.5.3.1 Generalidades</button></li>
                                    <li><button onclick="mostrarDetalle('7.5.3.2')" style="width: 100%; padding: 10px;">7.5.3.2 Actividades del Control de la Informaci√≥n documentada</button></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <!-- √Årea de detalle -->
                <div id="detalle-requisito" style="width: 60%; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">
                    <p>Selecciona un punto para ver el detalle.</p>
                </div>
            </div>
      `;
      break;

   case 'operacion':
      html = `
         <h3>8.0 Operaci√≥n</h3>
            <div style="display: flex; gap: 20px; width: 100%;">
                <!-- Lista de puntos para Operaci√≥n -->
                <ul style="width: 40%; list-style: none; padding: 0;">
                    <li><button onclick="mostrarDetalle('8.1')" style="width: 100%; padding: 10px;">8.1 Planificaci√≥n y control operacional</button></li>
                    
                    <li>
                        <button onclick="toggleSubMenu('submenu-8.2')" style="width: 100%; padding: 10px;">
                            8.2 Requisitos para los productos y servicios ‚ñº
                        </button>
                        <ul id="submenu-8.2" class="submenu" style="display: none; padding-left: 20px; list-style: none;">
                            <li><button onclick="mostrarDetalle('8.2.1')" style="width: 100%; padding: 10px;">8.2.1 Comunicaci√≥n con el Cliente</button></li>
                            <li><button onclick="mostrarDetalle('8.2.2')" style="width: 100%; padding: 10px;">8.2.2 Determinaci√≥n de los requisitos para los productos y servicios</button></li>
                            <li>
                                <button onclick="toggleSubMenu('submenu-8.2.3')" style="width: 100%; padding: 10px;">
                                    8.2.3 Revisi√≥n de los requisitos para los productos y servicios ‚ñº
                                </button>
                                <ul id="submenu-8.2.3" class="submenu" style="display: none; padding-left: 20px; list-style: none;">
                                    <li><button onclick="mostrarDetalle('8.2.3.1')" style="width: 100%; padding: 10px;">8.2.3.1 Generalidades de la revisi√≥n de los requisitos</button></li>
                                    <li><button onclick="mostrarDetalle('8.2.3.2')" style="width: 100%; padding: 10px;">8.2.3.2 Informaci√≥n documentada de la revisi√≥n de los requisitos</button></li>
                                </ul>
                            </li>
                            <li><button onclick="mostrarDetalle('8.2.4')" style="width: 100%; padding: 10px;">8.2.4 Cambios en los requisitos para los productos y servicios</button></li>
                        </ul>
                    </li>

                    <li>
                        <button onclick="toggleSubMenu('submenu-8.3')" style="width: 100%; padding: 10px;">
                            8.3 Dise√±o y desarrollo de los productos y servicios ‚ñº
                        </button>
                        <ul id="submenu-8.3" class="submenu" style="display: none; padding-left: 20px; list-style: none;">
                            <li><button onclick="mostrarDetalle('8.3.1')" style="width: 100%; padding: 10px;">8.3.1 Generalidades</button></li>
                            <li><button onclick="mostrarDetalle('8.3.2')" style="width: 100%; padding: 10px;">8.3.2 Planificaci√≥n del Dise√±o y Desarrollo</button></li>
                            <li><button onclick="mostrarDetalle('8.3.3')" style="width: 100%; padding: 10px;">8.3.3 Entradas para el dise√±o y desarrollo</button></li>
                            <li><button onclick="mostrarDetalle('8.3.4')" style="width: 100%; padding: 10px;">8.3.4 Controles del dise√±o y desarrollo</button></li>
                        </ul>
                    </li>

                    <li><button onclick="mostrarDetalle('8.6')" style="width: 100%; padding: 10px;">8.6 Liberaci√≥n de los productos y servicios</button></li>
                    
                    <li>
                        <button onclick="toggleSubMenu('submenu-8.7')" style="width: 100%; padding: 10px;">
                            8.7 Control de las salidas no conformes ‚ñº
                        </button>
                        <ul id="submenu-8.7" class="submenu" style="display: none; padding-left: 20px; list-style: none;">
                            <li><button onclick="mostrarDetalle('8.7.1')" style="width: 100%; padding: 10px;">8.7.1 Generalidades del control de las salidas no conformes</button></li>
                            <li><button onclick="mostrarDetalle('8.7.2')" style="width: 100%; padding: 10px;">8.7.2 Informaci√≥n documentada de las salidas no conformes</button></li>
                        </ul>
                    </li>
                </ul>
                <!-- √Årea de detalle -->
                <div id="detalle-requisito" style="width: 60%; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">
                    <p>Selecciona un punto para ver el detalle.</p>
                </div>
            </div>
      `;
      break;
      break;

    case 'desempeno':
      html = `
       <h3>9.0 Desempe√±o</h3>
        <div style="display: flex; gap: 20px; width: 100%;">
            <!-- Lista de puntos para Desempe√±o -->
            <ul style="width: 40%; list-style: none; padding: 0;">
                <li style="margin-bottom: 10px;">
                    <button onclick="toggleSubMenu('submenu-9.1')" style="width: 100%; padding: 10px;">
                        9.1 Seguimiento, medici√≥n, an√°lisis y evaluaci√≥n ‚ñº
                    </button>
                    <ul id="submenu-9.1" class="submenu" style="display: none; padding-left: 20px; list-style: none;">
                        <li><button onclick="mostrarDetalle('9.1.1')" style="width: 100%; padding: 10px;">9.1.1 Generalidades del seguimiento, medici√≥n, an√°lisis y evaluaci√≥n</button></li>
                        <li><button onclick="mostrarDetalle('9.1.2')" style="width: 100%; padding: 10px;">9.1.2 Satisfacci√≥n del Cliente</button></li>
                        <li><button onclick="mostrarDetalle('9.1.3')" style="width: 100%; padding: 10px;">9.1.3 An√°lisis y evaluaci√≥n</button></li>
                    </ul>
                </li>
                <li style="margin-bottom: 10px;">
                    <button onclick="toggleSubMenu('submenu-9.2')" style="width: 100%; padding: 10px;">
                        9.2 Auditor√≠a interna ‚ñº
                    </button>
                    <ul id="submenu-9.2" class="submenu" style="display: none; padding-left: 20px; list-style: none;">
                        <li><button onclick="mostrarDetalle('9.2.1')" style="width: 100%; padding: 10px;">9.2.1 Generalidades</button></li>
                        <li><button onclick="mostrarDetalle('9.2.2')" style="width: 100%; padding: 10px;">9.2.2 Auditor√≠a interna</button></li>
                    </ul>
                </li>
                <li style="margin-bottom: 10px;">
                    <button onclick="toggleSubMenu('submenu-9.3')" style="width: 100%; padding: 10px;">
                        9.3 Revisi√≥n por la direcci√≥n ‚ñº
                    </button>
                    <ul id="submenu-9.3" class="submenu" style="display: none; padding-left: 20px; list-style: none;">
                        <li><button onclick="mostrarDetalle('9.3.1')" style="width: 100%; padding: 10px;">9.3.1 Generalidades</button></li>
                        <li><button onclick="mostrarDetalle('9.3.2')" style="width: 100%; padding: 10px;">9.3.2 Entradas de la revisi√≥n</button></li>
                        <li><button onclick="mostrarDetalle('9.3.3')" style="width: 100%; padding: 10px;">9.3.3 Salidas de la revisi√≥n</button></li>
                    </ul>
                </li>
            </ul>
            <!-- √Årea de detalle -->
            <div id="detalle-requisito" style="width: 60%; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">
                <p>Selecciona un punto para ver el detalle.</p>
            </div>
        </div>
      `;
      break;

    case 'mejora':
      html = `
        <h3>10.0 Mejora</h3>
        <div style="display: flex; gap: 20px; width: 100%;">
            <!-- Lista de puntos para Mejora -->
            <ul style="width: 40%; list-style: none; padding: 0;">
                <li style="margin-bottom: 10px;">
                    <button onclick="mostrarDetalle('10.1')" style="width: 100%; padding: 10px;">
                        10.1 Generalidades de la Mejora
                    </button>
                </li>
                <li style="margin-bottom: 10px;">
                    <button onclick="toggleSubMenu('submenu-10.2')" style="width: 100%; padding: 10px;">
                        10.2 No conformidad y acci√≥n correctiva ‚ñº
                    </button>
                    <ul id="submenu-10.2" class="submenu" style="display: none; padding-left: 20px; list-style: none;">
                        <li><button onclick="mostrarDetalle('10.2.1')" style="width: 100%; padding: 10px;">10.2.1 Generalidades de no conformidades</button></li>
                        <li><button onclick="mostrarDetalle('10.2.2')" style="width: 100%; padding: 10px;">10.2.2 Informaci√≥n documentada</button></li>
                    </ul>
                </li>
                <li style="margin-bottom: 10px;">
                    <button onclick="mostrarDetalle('10.3')" style="width: 100%; padding: 10px;">
                        10.3 Mejora continua
                    </button>
                </li>
            </ul>
            <!-- √Årea de detalle -->
            <div id="detalle-requisito" style="width: 60%; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">
                <p>Selecciona un punto para ver el detalle.</p>
            </div>
        </div>
      `;
      break;

    default:
      html = `<p>Contenido no disponible para la pesta√±a seleccionada.</p>`;
  }

  requisitosContent.innerHTML = html;
}

// Funci√≥n para alternar la visibilidad de los subm√≥dulos
function toggleSubMenu(id) {
  const submenu = document.getElementById(id);
  if (!submenu) return;

  submenu.style.display = (submenu.style.display === 'none' || submenu.style.display === '') ? 'block' : 'none';
}

// Funci√≥n para mostrar el detalle del punto seleccionado con contenido completo
function mostrarDetalle(item) {
  const detalleDiv = document.getElementById('detalle-requisito');
  if (!detalleDiv) return;

  let detalleTexto = {
    "4.1": `<h4>4.1 Comprensi√≥n de la organizaci√≥n y su contexto</h4><p>SGC-4400-02 Rev: 1


En Aceites y L√≠pidos BD determinamos las cuestiones externas e internas que son pertinentes para nuestro prop√≥sito (misi√≥n) y direcci√≥n estrat√©gica (visi√≥n), que afectan nuestra capacidad para lograr los resultados previstos de nuestro Sistema de Gesti√≥n de la Calidad (cumplir regularmente los requisitos de los productos y servicios y aspirar a aumentar la satisfacci√≥n del cliente), desde el proceso Estrat√©gico (ver SGC-4400-70).

Realizamos el seguimiento y la revisi√≥n de la informaci√≥n sobre estas cuestiones externas e internas al actualizar el An√°lisis del contexto ejercido, durante la revisi√≥n por la direcci√≥n conforme se establece en el requisito de Entradas para la revisi√≥n por la direcci√≥n (SGC-4400-62) y en el procedimiento de Acciones para abordar riesgos y oportunidades y revisi√≥n directiva (PRO-6100-01).

De tal manera que conservamos el registro con el resumen de Riesgos y Oportunidades (REG-4100-01), asimismo conservamos el registro de requisitos pertinentes de las partes pertinentes (REG-6100-01)..</p>`,



    "4.2": `<h4>4.2 Comprensi√≥n de las necesidades y expectativas de las partes</h4><p>SGC-4400-03 Rev: 1


Debido a su efecto o efecto potencial en la capacidad de Aceites y L√≠pidos BD de proporcionar regularmente productos y servicios que satisfagan los requisitos del cliente, los legales y reglamentarios aplicables, a partir del proceso Estrat√©gico (ver SGC-4400-70), determinamos mediante el procedimiento de Acciones para abordar riesgos y oportunidades y revisi√≥n directiva (PRO-6100-01):

Las partes interesadas que son pertinentes a nuestro Sistema de Gesti√≥n de la Calidad;
Los requisitos pertinentes de estas partes interesadas para el Sistema de Gesti√≥n de la Calidad.
Conservamos registro que contiene los requisitos pertinentes en Partes Interesadas Pertinentes (REG-4200-01).
En Aceites y L√≠pidos BD realizamos el seguimiento y la revisi√≥n de la informaci√≥n sobre estas partes interesadas y sus requisitos pertinentes conforme se establece en el requisito 9.3.2 Entradas para la revisi√≥n por la direcci√≥n (SGC-4400-62), mediante la Revisi√≥n por la direcci√≥n ejercida.</p>`,



    "4.3": `<h4>4.3 Determinaci√≥n del alcance del SGC</h4><p>SGC-4400-04 Rev: 1


En Aceites y L√≠pidos BD determinamos el presente sistema de gesti√≥n de la calidad con el alcance para:

"Formulaci√≥n, envasado y distribuci√≥n de aceites vegetales y mantecas vegetales comestibles y comercializaci√≥n de materia prima asociadas".

Dado el alcance declarado y la naturaleza de nuestros productos y servicios hemos determinado que todos los requisitos de la norma ISO 9001:2015 son aplicables..</p>`,



//4.0

    "4.4.1": `<h4>4.4.1 Generalidades del SGC</h4><p>SGC-4400-05 Rev: 1


En Aceites y L√≠pidos BD establecemos, implementamos, mantenemos y mejoramos continuamente el presente sistema de gesti√≥n de la calidad incluidos los procesos necesarios y sus interacciones de acuerdo a los requisitos de la norma ISO 9001:2015.

Para lo cual establecemos en el Mapa General de Procesos (ver SGC-4400-68) los procesos necesarios para nuestro sistema de gesti√≥n de la calidad y su aplicaci√≥n a trav√©s de Aceites y L√≠pidos BD:

Determinamos las entradas requeridas y las salidas esperadas de estos procesos, (ver la determinaci√≥n del proceso Estrat√©gico (SGC-4400-69), de Ventas (SGC-4400-71) y de Producci√≥n y distribuci√≥n (SGC-4400-73);
Determinamos la secuencia mediante la numeraci√≥n asignada a cada proceso y la interacci√≥n de estos procesos conforme se observa en el mapa general de procesos (SGC-4400-68); el detalle se encuentra en la determinaci√≥n de los procesos (ver inciso a. del mismo requisito).
Determinamos y aplicamos los criterios y los m√©todos contenidos en los mapas de proceso espec√≠ficos, (ver el proceso Estrat√©gico (SGC-4400-70), de Ventas (SGC-4400-72) y de Producci√≥n y distribuci√≥n (SGC-4400-74)), necesarios para asegurarnos de la operaci√≥n eficaz y el control de estos procesos incluyendo el seguimiento y la medici√≥n a trav√©s de los objetivos de la calidad (SGC-4400-14);
Determinamos los recursos necesarios para estos procesos desde el flujo de efectivo validado y nos aseguramos de su disponibilidad mediante la aplicaci√≥n de nuestro proceso Estrat√©gico (SGC-4400-70);
Asignamos las responsabilidades, autoridades y roles para estos procesos mediante la Descripci√≥n de puestos (REG-5300-02) vinculadas desde el Organigrama (REG-5300-01), conforme a lo previsto en el requisito 5.3 (SGC-4400-11);
Abordar los riesgos y oportunidades determinados desde la Planificaci√≥n descrita en el requisito 6.1.1 del presente sistema de gesti√≥n de la calidad (ver SGC-4400-12);
Valoramos estos procesos mediante el seguimiento y medici√≥n de los objetivos de la calidad (ver requisito 6.2 del presente sistema de gesti√≥n de la calidad SGC-4400-14) e implementamos cualquier cambio necesario para asegurarnos de que estos procesos logran los resultados previstos;
En funci√≥n a los resultados de los objetivos de la calidad, instrumentamos mejoras a los procesos y al Sistema de Gesti√≥n de la Calidad, incluyendo cuando se presente incumplimiento a los objetivos durante el seguimiento se aplican correcciones a la medici√≥n y en caso de incumplimiento del objetivo, se aplican acciones correctivas conforme a lo previsto en el requisito 10.2.1 (SGC-4400-65).</p>`,



    "4.4.2": `<h4>4.4.2 Informaci√≥n documentada</h4><p>SGC-4400-06 Rev: 1


En Aceites y L√≠pidos BD:

Mantenemos la documentaci√≥n en la medida que nos resulta necesaria para apoyar la operaci√≥n de los procesos, en la que establecemos la manera de realizar las actividades para apoyar la operaci√≥n de los procesos, mediante la disponibilidad de:
Pol√≠tica de la calidad (SGC-4400-01)
Objetivos de la calidad (SGC-4400-14)
Mapa general de procesos (SGC-4400-68)
Mapa espec√≠fico de cada proceso:
Estrat√©gico (SGC-4400-70)
Ventas (SGC-4400-72)
Producci√≥n y distribuci√≥n (SGC-4400-74)
Determinaci√≥n de cada proceso:
Estrat√©gico (SGC-4400-69)
Ventas (SGC-4400-71)
Producci√≥n y distribuci√≥n (SGC-4400-73)
Metodolog√≠a descrita en Procedimientos, Videos, Audios, Ayudas visuales, Fotos, Software, entre otros, que se desprenden de cada mapa de proceso espec√≠fico o de los propios requisitos de nuestro Sistema de Gesti√≥n de la Calidad (ver lista maestra de control de documentos REG-7532-02).
Conservamos informaci√≥n documentada, para tener la confianza de que los procesos se realizan seg√∫n lo planificado, mediante la disponibilidad de registros. (ver lista maestra de control de registros REG-7532-04).</p>`,



//5.0
"5.1.1": `
      <h4>5.1.1 Generalidades</h4>
      <p>5.1.1 Generalidades Liderazgo y compromisoSGC-4400-07 Rev: 1


La alta direcci√≥n de Aceites y L√≠pidos BD mostramos liderazgo y compromiso con respecto al Sistema de Gesti√≥n de la Calidad; mediante la aplicaci√≥n del proceso Estrat√©gico (SGC-4400-70):

Asumiendo la rendici√≥n de cuentas de la eficacia del Sistema de Gesti√≥n de la Calidad (SGC-4400-61).
Asegurando que se establece la pol√≠tica de la calidad (SGC-4400-01) y los objetivos de la calidad (SGC-4400-14) y que estos sean compatibles con el contexto y la direcci√≥n estrat√©gica de Aceites y L√≠pidos BD;
Asegurando la integraci√≥n de los requisitos del Sistema de Gesti√≥n de la Calidad en los procesos de servicio de Aceites y L√≠pidos BD;
Promoviendo el uso del enfoque basado en procesos y el pensamiento basado en riesgos a lo largo de todo el Sistema de Gesti√≥n de la Calidad;
Asegurando que los recursos necesarios para el Sistema de Gesti√≥n de la Calidad est√©n disponibles ver requisito 7.1.1 del Sistema de Gesti√≥n de la Calidad (SGC-4400-18);
Comunicando la importancia de una gesti√≥n de la calidad eficaz y conforme con los requisitos del Sistema de Gesti√≥n de la Calidad;
Asegurando que el Sistema de Gesti√≥n de la Calidad logre los resultados previstos;
Comprometiendo, dirigiendo y apoyando a las personas para contribuir a la eficacia del Sistema de Gesti√≥n de la Calidad;
Promoviendo la mejora;
Apoyando los roles pertinentes de la direcci√≥n para demostrar su liderazgo aplicado a sus √°reas de responsabilidad ver requisito 5.3 del presente Sistema de Gesti√≥n de la Calidad (SGC-4400-11)..</p>
      `,
    "5.1.2": `
      <h4>5.1.2 Enfoque al Cliente</h4>
      <p>5.1.2 Enfoque al ClienteSGC-4400-08 Rev: 1


La Alta Direcci√≥n de Aceites y L√≠pidos BD que conduce muestra liderazgo y compromiso con respecto al enfoque al Cliente asegur√°ndonos de que:

Se determinan, se comprenden y se cumplen de manera coherente los requisitos del Cliente y los legales y reglamentarios aplicables, conforme a las actividades previstas en los procesos de:
Ventas (SGC-4400-72) y de Producci√≥n y distribuci√≥n (SGC-4400-74) y que adem√°s considera;
La evaluaci√≥n de la conformidad de los requisitos de los productos y servicios otorgados, conforme a lo descrito en el requisito 8.6 del presente Sistema de Gesti√≥n de la Calidad (SGC-4400-53)
Se determinan y se tratan los riesgos y oportunidades que pueden afectar a la conformidad de los productos y los servicios y a la capacidad de aumentar la satisfacci√≥n del Cliente, conforme se establece en los requisitos 4.1 (SGC-4400-02), 4.2 (SGC-4400-03) y 4.4.1 (SGC-4400-05) del presente Sistema de Gesti√≥n de la Calidad
Se mantiene el enfoque en aumentar la satisfacci√≥n del Cliente en todas las Personas que trabajan en nuestro nombre..</p>
    `,

    "5.2.1": `
      <h4>5.2.1 Establecimiento de la pol√≠tica de la calidad</h4>
      <p>5.2.1 Establecimiento de la pol√≠tica de la calidadSGC-4400-09 Rev: 1


La alta direcci√≥n de Aceites y L√≠pidos BD establece, implementa y mantiene la pol√≠tica de la calidad descrita en la pagina principal del presente Sistema de Gesti√≥n de la Calidad (SGC-4400-01) que:

Es apropiada a nuestro prop√≥sito (misi√≥n), a nuestro contexto (SGC-4400-02) y apoya la direcci√≥n estrat√©gica (visi√≥n);
Proporciona un marco de referencia para el establecimiento de los objetivos de la calidad, requisito 6.2 (Ver SGC-4400-14);
Incluye el compromiso de cumplir los requisitos aplicables;
Incluye el compromiso de mejora continua del Sistema de Gesti√≥n de la Calidad.</p>
    `,

    "5.2.2": `
      <h4>5.2.2 Comunicaci√≥n de la pol√≠tica de la calidad</h4>
      <p>5.2.2 Comunicaci√≥n de la pol√≠tica de la calidadSGC-4400-10 Rev: 1


La pol√≠tica de la calidad:

Est√° disponible desde la p√°gina principal de nuestro sistema de gesti√≥n de la calidad (SGC-4400-01), manteni√©ndole como informaci√≥n documentada;
Es comunicada a todas las Personas que trabajan en nuestro nombre mediante acceso a nuestro Sistema de Gesti√≥n de la Calidad electr√≥nico, nos aseguramos se entienda durante nuestras auditor√≠as internas y nos aseguramos sea aplicada dentro de su quehacer en Aceites y L√≠pidos BD;
Se encuentra disponible para las partes interesadas pertinentes, en la documentaci√≥n de nuestro sistema de gesti√≥n de la calidad, de lo anterior se hace participe a las partes interesadas en la comunicaci√≥n que les hacemos llegar.</p>
    `,

"5.3": `<h4> 5.3 Roles, responsabilidades y autoridades organizacionales</h4><p>5.3 Roles, responsabilidades y autoridades en la organizaci√≥nSGC-4400-11 Rev: 1


La alta direcci√≥n de Aceites y L√≠pidos BD se asegura que las responsabilidades y autoridades para los roles pertinentes se asignan, se comunican y se entiendan dentro de la organizaci√≥n, mediante las Descripciones de puesto (ver REG-5300-02), asimismo, se muestra el puesto de cada persona en el Organigrama general (ver REG-5300-01).

La alta direcci√≥n asignamos la responsabilidad y autoridad para:

Asegurarnos de que el sistema de gesti√≥n de la calidad es conforme con los requisitos de la norma ISO 9001:2015.
Asegurarnos de que los procesos est√°n dando las salidas previstas;
Informar a la alta direcci√≥n sobre el desempe√±o del sistema de gesti√≥n de la calidad, y sobre las oportunidades de mejora (v√©ase 10.1, SGC-4400-64 del presente sistema de gesti√≥n de la calidad);
Asegurarnos de que se promueve el enfoque al Cliente a trav√©s de la organizaci√≥n;
Asegurarnos de que la integridad del sistema de gesti√≥n de la calidad se mantiene cuando se planifican e implementan cambios en el sistema de gesti√≥n e la calidad
Mediante el control para la Creaci√≥n y actualizaci√≥n de la informaci√≥n documentada como se establece en el requisito 7.5.2 del presente manual, para cambios del d√≠a a d√≠a (ver SGC-4400-29).
Adicionalmente mediante la contribuci√≥n de la revisi√≥n por la direcci√≥n cuando se prev√©n cambios que pudieran impactar de manera significativa al sistema de gesti√≥n de la calidad (ver SGC-4400-62).</p>`,




//6.0
"6.1.1": `
      <h4>6.1.1 Planificaci√≥n del sistema de gesti√≥n de la calidad</h4>
      <p>6.1.1 Planificaci√≥n del sistema de gesti√≥n de la calidadSGC-4400-12 Rev: 1


Al planificar el sistema de gesti√≥n de la calidad, en Aceites y L√≠pidos BD consideramos las cuestiones referidas en el apartado 4.1 (ver SGC-4400-02) y los requisitos referidos en el apartado 4.2 (ver SGC-4400-03) de tal forma que determinamos las oportunidades y los riesgos que es necesario abordar mediante la aplicaci√≥n del proceso Estrat√©gico (SGC-4400-70), con el fin de:

Asegurarnos de que el sistema de gesti√≥n de la calidad pueda lograr sus resultados previstos;
Aumentar los efectos deseables;
Prevenir o reducir efectos no deseados;
Lograr la mejora.</p>
    `,

    "6.1.2": `
      <h4>6.1.2 Requisitos para planificar</h4>
      <p>6.1.2 Requisitos para planificarSGC-4400-13 Rev: 1


En Aceites y L√≠pidos BD planificamos:

Las acciones para abordar estos riesgos y oportunidades, de tal forma que;
Integramos e implementamos las acciones en los procesos del sistema de gesti√≥n de la calidad al presentar su determinaci√≥n, ver:
Estrat√©gico (SGC-4400-69)
Ventas (SGC-4400-71)
Producci√≥n y distribuci√≥n (SGC-4400-73)
Evaluamos la eficacia de estas acciones, durante la revisi√≥n por la direcci√≥n (ver SGC-4400-61).</p>  `,

"6.2": `<h4>6.2 Objetivos de la calidad y planificaci√≥n para lograrlos</h4><p>6.2.1 Objetivos de la calidadSGC-4400-15 Rev: 1


En Aceites y L√≠pidos BD establecemos los objetivos de la calidad para las funciones, niveles y procesos pertinentes necesarios para el Sistema de Gesti√≥n de la Calidad:

Los objetivos de la calidad:

Son coherentes con la pol√≠tica de la calidad, lo cual aseguramos mediante el establecimiento en la tabla contenida en el requisito 6.2 del presente sistema de gesti√≥n de la calidad (SGC-4400-14)
Son medibles;
Tienen en cuenta los requisitos aplicables;
Son pertinentes para la conformidad de los productos y servicios y para el aumento de la satisfacci√≥n del Cliente;
Son objeto de seguimiento al ser el par√°metro principal para el seguimiento y medici√≥n de los procesos (ver requisito 4.4.1g del presente Sistema de Gesti√≥n de la Calidad, (SGC-4400-05);
Se comunican, ver requisito 7.4 del presente Sistema de Gesti√≥n de la Calidad (SGC-4400-27);
Se actualizan, seg√∫n corresponda ver requisito 7.5.3.2 del presente Sistema de Gesti√≥n de la Calidad (SGC-4400-31).
Los objetivos de la Calidad se mantienen como informaci√≥n documentada en el requisito 6.2 del presente (ver SGC-4400-14).</p>`,





    "6.2.1": `<h4>6.2.1 Objetivos de la calidad</h4><p>6.2.1 Objetivos de la calidadSGC-4400-15 Rev: 1


En Aceites y L√≠pidos BD establecemos los objetivos de la calidad para las funciones, niveles y procesos pertinentes necesarios para el Sistema de Gesti√≥n de la Calidad:

Los objetivos de la calidad:

Son coherentes con la pol√≠tica de la calidad, lo cual aseguramos mediante el establecimiento en la tabla contenida en el requisito 6.2 del presente sistema de gesti√≥n de la calidad (SGC-4400-14)
Son medibles;
Tienen en cuenta los requisitos aplicables;
Son pertinentes para la conformidad de los productos y servicios y para el aumento de la satisfacci√≥n del Cliente;
Son objeto de seguimiento al ser el par√°metro principal para el seguimiento y medici√≥n de los procesos (ver requisito 4.4.1g del presente Sistema de Gesti√≥n de la Calidad, (SGC-4400-05);
Se comunican, ver requisito 7.4 del presente Sistema de Gesti√≥n de la Calidad (SGC-4400-27);
Se actualizan, seg√∫n corresponda ver requisito 7.5.3.2 del presente Sistema de Gesti√≥n de la Calidad (SGC-4400-31).
Los objetivos de la Calidad se mantienen como informaci√≥n documentada en el requisito 6.2 del presente (ver SGC-4400-14).</p>`,

    "6.2.2": `<h4>6.2.2 Planificaci√≥n para lograr los objetivos</h4><p>6.2.2 Planificaci√≥n para lograr los objetivosSGC-4400-16 Rev: 1


Al planificar c√≥mo lograr los objetivos de la calidad, en Aceites y L√≠pidos BD incluimos dentro de la informaci√≥n documentada establecida en el requisito SGC-4400-14 del presente sistema de gesti√≥n de la calidad:

Qu√© se va a hacer;
Qu√© recursos se requerir√°n;
Qui√©n ser√° el responsable;
Cu√°ndo se finalizar√°;
C√≥mo se evaluar√°n los resultados.</p>`,

    "6.3": `<h4>6.3 Planificaci√≥n de los cambios</h4><p>6.3 Planificaci√≥n de los cambiosSGC-4400-17 Rev: 1


Cuando en Aceites y L√≠pidos BD determinamos la necesidad de realizar cambios en el sistema de gesti√≥n de la calidad, estos son llevados a cabo de conformidad con los controles previstos en la secci√≥n SGC-4400-29 del presente y de manera sistem√°tica (ver SGC-4400-06).

Para lo cual consideramos:

El prop√≥sito de los cambios y sus consecuencias potenciales;
La integridad del sistema de gesti√≥n de la calidad;
La disponibilidad de recursos;
La asignaci√≥n o reasignaci√≥n de responsabilidades y autoridades.</p>`,
 
 //7.0
    "7.1.1": `<h4>7.1.1 Generalidades de Recursos</h4><p>7.1.1 Generalidades de RecursosSGC-4400-18 Rev: 1


En Aceites y L√≠pidos BD determinamos y proporcionamos los recursos necesarios para el establecimiento, implementaci√≥n, mantenimiento y mejora continua del sistema de gesti√≥n de la calidad, mediante el seguimiento del Flujo de efectivo semanal para gastos de gasolina, casetas, tambores, bolsas de pl√°stico, cubetas, bidones, desengrasante, cajas, jarcier√≠a,papeleria, hardwere y cualquier imprevisto que llegue a sucitarse.

 
Para lo cual consideramos:

Las capacidades y limitaciones de los recursos internos existentes, mediante la aplicaci√≥n del proceso Estrat√©gico (SGC-4400-70);
Qu√© se necesita obtener de los proveedores externos, conforme se prev√©n los procesos en general y ejercido en la fase de compras, previsto en el proceso Estrat√©gico (SGC-4400-70).</p>`,


    "7.1.2": `<h4>7.1.2 Personas</h4><p>7.1.2 PersonasSGC-4400-19 Rev: 1


En Aceites y L√≠pidos BD determinamos y proporcionamos las personas necesarias para implementaci√≥n eficaz del sistema de gesti√≥n de la calidad y para la operaci√≥n y control de sus procesos, mediante la aplicaci√≥n del proceso Estrat√©gico (SGC-4400-70).</p>`,

    "7.1.3": `<h4>7.1.3 Infraestructura</h4><p>7.1.3 InfraestructuraSGC-4400-20 Rev: 1


En Aceites y L√≠pidos BD determinamos a partir de flujo de efectivo, proporcionamos mediante el ejercicio del mismo y mantenemos la infraestructura necesaria para que la operaci√≥n de nuestros procesos logren la conformidad de nuestros servicios, mediante el proceso Estrat√©gico (SGC-4400-70).

La infraestructura necesaria es:

Espacios de trabajo y servicios asociados;
Equipo, incluyendo hardware y software, as√≠ como el equipo necesario para el funcionamiento del servicio;
Recursos de transporte en las condiciones necesarias para el funcionamiento correcto del servicio;
Tecnolog√≠a de la informaci√≥n y la comunicaci√≥n.</p>`,

    "7.1.4": `<h4>7.1.4 Ambiente para la operaci√≥n de los procesos</h4><p>7.1.4 Ambiente para la operaci√≥n de los procesosSGC-4400-21 Rev: 1


En Aceites y L√≠pidos BD determinamos como ambiente de trabajo aquella combinaci√≥n de factores sociales, psicol√≥gicos y f√≠sicos, como los detallamos de acuerdo con nuestra operaci√≥n:

Sociales, al evitar la discriminaci√≥n.
Psicosociales;
Los factores f√≠sicos atendidos desde el requisito 7.1.3 del Sistema de Gesti√≥n de la Calidad (SGC-4400-20).
Lo anterior a trav√©s de la aplicaci√≥n del Proceso Estrat√©gico (SGC-4400-70). </p>`,


//PENDIENTE 7.1.5 SE DE VA A√ëADIR MAS FUNCIONES 

    "7.1.5": `<h4>7.1.5 Recursos de seguimiento y medici√≥n</h4><p>Herramientas y m√©todos para medir el desempe√±o del sistema de gesti√≥n de la calidad.</p>`,

"7.1.5.1": `<h4>7.1.5.1 Generalidades de Recursos de seguimiento y medici√≥n</h4>
<p>SGC-7100-01 Rev: 1</p>

<p>La organizaci√≥n debe determinar y proporcionar los recursos necesarios para asegurarse de la validez y 
fiabilidad de los resultados cuando se realice el seguimiento o la medici√≥n para verificar la conformidad 
de los productos y servicios con los requisitos.</p>

<p>La organizaci√≥n debe asegurarse de que los recursos proporcionados:</p>

<ul>
  <li>Son apropiados para el tipo espec√≠fico de actividades de seguimiento y medici√≥n realizadas.</li>
  <li>Se mantienen calibrados, verificados y documentados conforme a los procedimientos establecidos.</li>
  <li>Son utilizados √∫nicamente por personal competente y capacitado para su correcta operaci√≥n.</li>
  <li>Cuentan con registros actualizados de mantenimiento, calibraci√≥n y verificaci√≥n (REG-7100-02).</li>
  <li>Permiten asegurar resultados confiables que sirvan como base para la toma de decisiones y la mejora continua.</li>
</ul>

<p>De esta manera, Aceites y L√≠pidos BD garantiza la confiabilidad de los procesos de seguimiento y medici√≥n, 
cumpliendo con los requisitos de la norma ISO 9001:2015.</p>`,



"7.1.5.2": `<h4>7.1.5.2 Trazabilidad de las mediciones</h4>
<p>SGC-7100-02 Rev: 1</p>

<p>Cuando la trazabilidad de las mediciones es un requisito, o es considerada por la organizaci√≥n como 
parte esencial para proporcionar confianza en la validez de los resultados de la medici√≥n, el equipo de 
medici√≥n debe:</p>

<ul>
  <li><strong>a)</strong> Calibrarse o verificarse, o ambas, a intervalos especificados, o antes de su utilizaci√≥n, contra 
  patrones de medici√≥n trazables a patrones de medici√≥n internacionales o nacionales; cuando no 
  existan tales patrones, debe conservarse como informaci√≥n documentada la base utilizada para la 
  calibraci√≥n o la verificaci√≥n.</li>

  <li><strong>b)</strong> Identificarse para determinar su estado.</li>

  <li><strong>c)</strong> Protegerse contra ajustes, da√±o o deterioro que pudieran invalidar el estado de calibraci√≥n y los 
  posteriores resultados de la medici√≥n.</li>
</ul>

<p>La organizaci√≥n debe determinar si la validez de los resultados de medici√≥n previos se ha visto afectada 
de manera adversa cuando el equipo de medici√≥n se considere no apto para su prop√≥sito previsto, y 
debe tomar las acciones adecuadas cuando sea necesario.</p>`,



    "7.1.6": `<h4>7.1.6 Conocimientos de la organizaci√≥n</h4><p>7.1.6 Conocimientos de la organizaci√≥nSGC-4400-24 Rev: 1


En Aceites y L√≠pidos BD determinamos los conocimientos necesarios para la operaci√≥n de nuestros procesos y para lograr la conformidad de los productos y servicios, situaci√≥n prevista del proceso Estrat√©gico (SGC-4400-70).

Estos conocimientos se mantienen y se ponen a disposici√≥n en la extensi√≥n necesaria, mediante la aplicaci√≥n del proceso Estrat√©gico (SGC-4400-70)),   

Al tratar las necesidades y tendencias cambiantes, en Aceites y L√≠pidos BD consideramos los conocimientos actuales y determinar como adquirir o acceder a los conocimientos adicionales necesarios y a las actualizaciones requeridas, ver proceso Estrat√©gico (SGC-4400-70)..</p>`,

    "7.2": `<h4>7.2 Competencia</h4><p>7.2 CompetenciaSGC-4400-25 Rev: 1


En Aceites y L√≠pidos BD:

Determinamos, a trav√©s del Perfil de puestos (REG-7200-01), la competencia necesaria de las personas que colaboran dentro de nuestra organizaci√≥n mediante la aplicaci√≥n del proceso Estrat√©gico (SGC-4400-70);
Nos aseguramos que estas personas son competentes, bas√°ndose en la educaci√≥n, formaci√≥n o experiencia adecuadas, desde el momento de su contrataci√≥n y mediante la evaluaci√≥n del desempe√±o anual para determinar el cumplimiento de las competencias del personal administrativo o en su caso la detecci√≥n de necesidades de capacitaci√≥n.
Cuando sea aplicable, tomamos acciones (cursos de capacitaci√≥n) para adquirir la competencia necesaria y evaluar la eficacia de las acciones tomadas;
Conservamos el expediente de personal como evidencia de la competencia de las personas que colaboran dentro de nuestra organizaci√≥n y evidencia de competencia espec√≠fica de las personas que contribuyen de manera externa.</p>`,

    "7.3": `<h4>7.3 Toma de conciencia</h4><p>7.3 Toma de concienciaSGC-4400-26 Rev: 1


La Alta Direcci√≥n se asegura de que las personas pertinentes que realizan el trabajo bajo el control de Aceites y L√≠pidos BD, toman conciencia de:

La pol√≠tica de la calidad (SGC-4400-01);
Los objetivos de la calidad pertinentes (SGC-4400-14);
Su contribuci√≥n a la eficacia del sistema de gesti√≥n de la calidad, incluyendo los beneficios de una mejora del desempe√±o;
Las implicaciones de no cumplir los requisitos del sistema de gesti√≥n de la calidad..</p>`,

    "7.4": `<h4>7.4 Comunicaci√≥n</h4><p>7.4 Comunicaci√≥nSGC-4400-27 Rev: 1


En Aceites y L√≠pidos BD determinamos la comunicaci√≥n interna y externa pertinente al sistema de gesti√≥n de la calidad que considera: Qu√© comunicar, cu√°ndo comunicar, a qui√©n comunicar, c√≥mo comunicar y qui√©n comunica, mediante la base establecida en la Tabla de Comunicaci√≥n (REG-7400-01).</p>`,

    "7.5.1": `<h4>7.5.1 Generalidades de informaci√≥n documentada</h4><p>7.5.1 Generalidades de informaci√≥n documentadaSGC-4400-28 Rev: 1


El sistema de gesti√≥n de la calidad de Aceites y L√≠pidos BD incluye:

La informaci√≥n documentada requerida por la norma ISO 9001:2015, que son: El alcance (SGC-4400-04); la pol√≠tica y los objetivos de la calidad (SGC-4400-01), la planificaci√≥n y control operacional que se desprende del mapa general de los procesos, incluidos los registros requeridos por norma para mostrar evidencia de que conservamos la informaci√≥n documentada necesaria (SGC-4400-68), y referenciada en la lista maestra de control de registros (REG-7532-04),

La informaci√≥n documentada que en Aceites y L√≠pidos BD determinamos como necesaria para la eficacia del sistema de gesti√≥n de la calidad, contenida en la presente plataforma electr√≥nica:

Las diferentes p√°ginas del sistema de gesti√≥n de la calidad (REG-7532-01);
Lista maestra de control de informaci√≥n documentada mantenida (REG-7532-02);
Lista maestra de control de documentos externos (REG-7532-03);
Lista maestra de control de registros (REG-7532-04).</p>`,

    "7.5.2": `<h4>7.5.2 Creaci√≥n y actualizaci√≥n de informaci√≥n documentada</h4><p>7.5.2 Creaci√≥n y actualizaci√≥n de informaci√≥n documentadaSGC-4400-29 Rev: 1


Mediante actividades consideradas en el proceso Estrat√©gico (SGC-4400-70), en Aceites y L√≠pidos BD, nos aseguramos de que lo siguiente sea apropiado:

Identificaci√≥n y descripci√≥n: Todos los documentos del sistema de gesti√≥n de la calidad quedan identificados mediante el t√≠tulo contenido en el mismo. En el caso de los procedimientos por sus caracter√≠sticas, adicionalmente incluye la fecha de elaboraci√≥n en el encabezado. En el pie de p√°gina el elaborador (o autor), revisor y aprobador, as√≠ como las fechas en que √©stos han sido elaborados, revisados y aprobados, adicionalmente todos los documentos creados por Aceites y L√≠pidos BD dentro del Sistema de Gesti√≥n de la Calidad (incluidos los formatos de registro) se identifican mediante c√≥digo conforme se describe en el procedimiento de Elaboraci√≥n de documentos (PRO-7520-01).

El formato de la documentaci√≥n del Sistema de Gesti√≥n de la Calidad presentada en idioma espa√±ol y medio electr√≥nico;

Revisi√≥n y aprobaci√≥n con respecto a la conveniencia y adecuaci√≥n: Todo documento ser√° revisado en cuanto a la conveniencia y adecuaci√≥n mediante la revisi√≥n de la propuesta ejercida por el/la Responsable de Almac√©n conforme se describe en el procedimiento de Control de documentos (PRO-7532-01).</p>`,






    "7.5.3": `<h4>7.5.3 Control de la informaci√≥n documentada</h4><p>Procedimientos para controlar la documentaci√≥n del sistema de gesti√≥n de la calidad.</p>`,



"7.5.3.1": `<h4>7.5.3.1 Control de la informaci√≥n documentada</h4>
<p>SGC-7500-01 Rev: 1</p>

<p>La informaci√≥n documentada requerida por el sistema de gesti√≥n de la calidad y por esta 
Norma Internacional se debe controlar para asegurarse de que:</p>

<ul>
  <li><strong>a)</strong> Est√© disponible y sea id√≥nea para su uso, donde y cuando se necesite.</li>
  <li><strong>b)</strong> Est√© protegida adecuadamente (por ejemplo, contra p√©rdida de la confidencialidad, uso inadecuado o p√©rdida de integridad).</li>
</ul>`,

"7.5.3.2": `<h4>7.5.3.2 Actividades para el control de la informaci√≥n documentada</h4>
<p>SGC-7500-02 Rev: 1</p>

<p>Para el control de la informaci√≥n documentada, la organizaci√≥n debe abordar las siguientes 
actividades, seg√∫n corresponda:</p>

<ul>
  <li><strong>a)</strong> Distribuci√≥n, acceso, recuperaci√≥n y uso.</li>
  <li><strong>b)</strong> Almacenamiento y preservaci√≥n, incluida la preservaci√≥n de la legibilidad.</li>
  <li><strong>c)</strong> Control de cambios (por ejemplo, control de versi√≥n).</li>
  <li><strong>d)</strong> Conservaci√≥n y disposici√≥n.</li>
</ul>

<p>La informaci√≥n documentada de origen externo, que la organizaci√≥n determina como necesaria 
para la planificaci√≥n y operaci√≥n del sistema de gesti√≥n de la calidad, se debe identificar, seg√∫n sea 
apropiado, y controlar.</p>

<p>La informaci√≥n documentada conservada como evidencia de la conformidad debe protegerse contra 
modificaciones no intencionadas.</p>`,




    //8.0
    "8.1": `<h4>8.1 Planificaci√≥n y control operacional</h4><p>8.1 Planificaci√≥n y control operacionalSGC-4400-32 Rev: 1


En Aceites y L√≠pidos BD planificamos, implementamos y controlamos los procesos de Ventas (SGC-4400-72) y de Producci√≥n y distribuci√≥n (SGC-4400-74), los cuales son necesarios para cumplir los requisitos para la producci√≥n de productos y prestaci√≥n de servicios y para implementar las acciones determinadas en el capitulo 6, mediante:

La determinaci√≥n para los requisitos para nuestros servicios;
El establecimiento de criterios:
para los procesos;
la aceptaci√≥n de productos y servicios;
La determinaci√≥n de los recursos necesarios para lograr la conformidad de los requisitos de los productos y servicios;
La implementaci√≥n del control de los procesos de acuerdo a los criterios;
La determinaci√≥n y almacenaje de la informaci√≥n documentada en la medida necesaria:
Para confiar en que los procesos se han llevado a cabo seg√∫n lo planificado en los mapas y determinaci√≥n de procesos y documentos que se desprenden de √©stos, conforme se establece en el requisito 4.4.2 a) (ver SGC-4400-06);
Para demostrar la conformidad de servicios y productos con a sus requisitos ver 4.4.2 b) (ver SGC-4400-06).</p>`,


    "8.2.1": `<h4>8.2.1 Comunicaci√≥n con el Cliente</h4><p>8.2.1 Comunicaci√≥n con el Cliente.SGC-4400-33 Rev: 1


La comunicaci√≥n con nuestros Clientes incluido en la fase comercial del proceso de Ventas (SGC-4400-72), considera:

Proporcionar la informaci√≥n relativa a los productos y servicios;
La atenci√≥n de las consultas, los contratos o pedidos, incluyendo los cambios;
Obtener la retroalimentaci√≥n de los Clientes relativos a los productos y servicios, incluyendo sus quejas;
Manipular o controlar las propiedades del Cliente;
Establecer los requisitos espec√≠ficos para las acciones de contingencia, cuando sea pertinente.</p>`,

    "8.2.2": `<h4>8.2.2 Determinaci√≥n de los requisitos</h4><p>8.2.2 Determinaci√≥n de los requisitos para los productos y serviciosSGC-4400-34 Rev: 1


Cuando determinamos los requisitos para los productos y servicios que se ofrecen a los Clientes, en Aceites y L√≠pidos BD nos aseguramos de que:

Los requisitos para los productos y servicios se definen, incluyendo:
Cualquier requisito legal y reglamentario aplicables;
Aquellos considerados necesarios por Aceites y L√≠pidos BD;
Aceites y L√≠pidos BD puede atender las reclamaciones de los productos y servicios que ofrece.</p>`,





//PENDIENTE 8.2.3

    "8.2.3": `<h4>8.2.3 Revisi√≥n de los requisitos</h4><p>. </p>`,



"8.2.3.1": `<h4>8.2.3.1 Revisi√≥n de los requisitos de los productos y servicios</h4>
<p>SGC-8200-01 Rev: 1</p>

<p>La organizaci√≥n debe asegurarse de que tiene la capacidad de cumplir los requisitos para los 
productos y servicios que se van a ofrecer a los clientes. La organizaci√≥n debe llevar a cabo una revisi√≥n 
antes de comprometerse a suministrar productos y servicios a un cliente, para incluir:</p>

<ul>
  <li><strong>a)</strong> Los requisitos especificados por el cliente, incluyendo los requisitos para las actividades de entrega y las posteriores a la misma.</li>
  <li><strong>b)</strong> Los requisitos no establecidos por el cliente, pero necesarios para el uso especificado o previsto, cuando sea conocido.</li>
  <li><strong>c)</strong> Los requisitos especificados por la organizaci√≥n.</li>
  <li><strong>d)</strong> Los requisitos legales y reglamentarios aplicables a los productos y servicios.</li>
  <li><strong>e)</strong> Las diferencias existentes entre los requisitos del contrato o pedido y los expresados previamente.</li>
</ul>

<p>La organizaci√≥n debe asegurarse de que se resuelven las diferencias existentes entre los requisitos del 
contrato o pedido y los expresados previamente.</p>

<p>La organizaci√≥n debe confirmar los requisitos del cliente antes de la aceptaci√≥n, cuando el cliente no 
proporcione una declaraci√≥n documentada de sus requisitos.</p>`,



"8.2.3.2": `<h4>8.2.3.2 Informaci√≥n documentada de los requisitos de los productos y servicios</h4>
<p>SGC-8200-02 Rev: 1</p>

<p>La organizaci√≥n debe conservar la informaci√≥n documentada, cuando sea aplicable, sobre:</p>

<ul>
  <li><strong>a)</strong> Los resultados de la revisi√≥n de los requisitos.</li>
  <li><strong>b)</strong> Cualquier requisito nuevo para los productos y servicios.</li>
</ul>`,






    "8.2.4": `<h4>8.2.4 Cambios en los requisitos para los productos y servicios
La organizaci√≥n debe asegurarse de que, cuando se cambien los requisitos para los productos y 
servicios, la informaci√≥n documentada pertinente sea modificada, y de que las personas pertinentes 
sean conscientes de los requisitos modificados.</h4><p8.2.4 Cambios en los requisitos para los productos y serviciosSGC-4400-37 Rev: 1


En Aceites y L√≠pidos BD nos aseguramos mediante la aplicaci√≥n desde los procesos de Ventas (SGC-4400-72) y de Producci√≥n y distribuci√≥n (SGC-4400-74) que la informaci√≥n documentada pertinente sea modificada y de que las personas correspondientes sean conscientes de los requisitos modificados cuando se cambien los requisitos para los productos y servicios.</p>`,

    "8.3.1": `<h4>8.3.1 Generalidades del Dise√±o</h4><p>8.3.1 Generalidades del dise√±o y desarrollo de los productos y serviciosSGC-4400-38 Rev: 1


En Aceites y L√≠pidos BD establecemos, implementamos y mantenemos el proceso de Ventas (SGC-4400-72) para asegurarnos del √©xito de nuestra organizaci√≥n que es la formulaci√≥n, fabricaci√≥n y distribuci√≥n de aceites y mantecas comestibles, y que asegura la adecuaci√≥n para la provisi√≥n de productos y servicios adecuados a las necesidades de nuestros clientes.</p>`,

    "8.3.2": `<h4>8.3.2 Planificaci√≥n del Dise√±o</h4><p>8.3.2 Planificaci√≥n del Dise√±o y desarrolloSGC-4400-39 Rev: 1


Al determinar las etapas y controles para la formulaci√≥n y desarrollo, en la planificaci√≥n del proceso de Ventas (SGC-4400-72) en Aceites y L√≠pidos BD consideramos:

la naturaleza, duraci√≥n y complejidad de las actividades de la formulaci√≥n y desarrollo;
las etapas del proceso requeridas, incluyendo las revisiones de la formulaci√≥n y desarrollo aplicables;
las actividades requeridas de verificaci√≥n y validaci√≥n de la formulaci√≥n y desarrollo;
las responsabilidades y autoridades involucradas en el proceso de la formulaci√≥n y desarrollo;
las necesidades de recursos internos y externos para la formulaci√≥n y desarrollo de los productos y servicios;
la necesidad de controlar las interfaces entre las personas que participan activamente en el proceso de la formulaci√≥n y desarrollo;
la necesidad de la participaci√≥n activa de los clientes y usuarios en el proceso de la formulaci√≥n y desarrollo;
los requisitos para la posterior provisi√≥n de productos y servicios;
el nivel de control del proceso de la formulaci√≥n y desarrollo esperado por los clientes y otras partes interesadas pertinentes;
los procedimientos y registros que se desprenden del proceso de Ventas (SGC-4400-72) para demostrar que se han cumplido los requisitos de la formulaci√≥n y desarrollo.</p>`,

    "8.3.3": `<h4>8.3.3 Entradas para el dise√±o</h4><p>8.3.3 Entradas para el dise√±o y desarrolloSGC-4400-40 Rev: 1


En Aceites y L√≠pidos BD determinamos los requisitos esenciales para los tipos espec√≠ficos de productos y servicios a formular y desarrollar, para lo cual consideramos, mediante la f√≥rmula, tiempos de agitaci√≥n y punto de fusi√≥n:

los requisitos funcionales y de desempe√±o, como son las caracter√≠sticas de uso, tiempo esperado de funcionalidad, entre otros;
la informaci√≥n proveniente de actividades previas de formulaci√≥n y desarrollo similares, cuando hubi√©ramos implementado productos o servicios semejantes, aprovechando experiencias;
los requisitos legales y reglamentarios;
normas o c√≥digos de pr√°cticas que hubieramos comprometido a implementar;
las consecuencias potenciales de fallar debido a la naturaleza de los productos y servicios.
Las entradas son adecuadas para los fines del dise√±o y desarrollo, estan completas y sin ambig√ºedades.

Las entradas del dise√±o y desarrollo contradictorias deben resolverse.

Conservamos registros de los levantamientos realizados en la fase comercial para disponer de certeza sobre las entradas del dise√±o y desarrollo.</p>`,


    "8.3.4": `<h4>8.3.4 Controles del dise√±o</h4><p>8.3.4 Controles del dise√±o y desarrolloSGC-4400-41 Rev: 1


En Aceites y L√≠pidos BD aplicamos controles desde el proceso de Ventas (SGC-4400-72) para asegurarnos de que:

se definen los resultados a lograr;
se realizan las revisiones para evaluar la capacidad de los resultados de la formulaci√≥n y desarrollo para cumplir los requisitos;
se realizan actividades de verificaci√≥n para asegurarse de que las salidas de la formulaci√≥n y desarrollo cumplen los requisitos de las entradas;
se realizan actividades de validaci√≥n para asegurarse de que los productos y servicios resultante satisfacen los requisitos para su aplicaci√≥n especificada o uso previsto;
se toma cualquier acci√≥n necesaria sobre los problemas determinados durante las revisiones, o las actividades de verificaci√≥n y validaci√≥n;
se conserva registro de las revisiones, ajustes, validaciones mediante los planos y muestras de impresi√≥n.</p>`,

    "8.3.5": `<h4>8.3.5 Salidas del dise√±o</h4><p>8.3.5 Salidas del dise√±o y desarrolloSGC-4400-42 Rev: 1


En Aceites y L√≠pidos BD aseguramos de que las f√≥rmulas y muestras:

cumplen los requisitos de las entradas (SGC-4400-40);
son adecuadas para el proceso de Ventas (SGC-4400-72) para la provisi√≥n de productos y servicios;
incluyen o hacen referencia a los requisitos de seguimiento y medici√≥n y los criterios de aceptaci√≥n;
especifican las caracter√≠sticas de los productos y servicios que son esenciales para su prop√≥sito previsto y su provisi√≥n segura y correcta.
En Aceites y L√≠pidos BD conservamos f√≥rmulas, muestras y dem√°s registros sobre las salidas de la formulaci√≥n y desarrollo.</p>`,

    "8.3.6": `<h4>8.3.6 Cambios en el dise√±o</h4><p>8.3.6 Cambios del dise√±o y desarrolloSGC-4400-43 Rev: 1


En Aceites y L√≠pidos BD identificamos, revisamos y controlamos los cambios hechos durante la formulaci√≥n y desarrollo de los productos y servicios, o posteriormente en la medida necesaria para asegurarnos de que no haya un impacto adverso en la conformidad con los requisitos.

Mediante el control de f√≥rmulas y muestras, conservamos registros sobre:

los cambios de la formulaci√≥n y desarrollo;
los resultados de las revisiones;
la autorizaci√≥n de los cambios;</p>`,


"8.4.1": `<h4>8.4.1 Generalidades del control de los procesos, productos y servicios suministrados externamente</h4><p>8.4.1 Generalidades del control de los procesos, productos y servicios suministrados externamenteSGC-4400-44 Rev: 1


En Aceites y L√≠pidos BD nos aseguramos de que los productos y servicios suministrados externamente son conformes a los requisitos, mediante la aplicaci√≥n del proceso Estrat√©gico (SGC-4400-70) como soporte para la operaci√≥n.

Para lo que determinamos los controles a aplicar a los procesos, productos y servicios suministrados externamente cuando:

Los productos y servicios de proveedores externos est√°n destinados a incorporarse dentro de nuestros propios productos y servicios de Aceites y L√≠pidos BD;
Etapas de los productos y servicios son proporcionados directamente a los Clientes por proveedores externos en nombre de Aceites y L√≠pidos BD;
Para lo que determinamos y aplicamos criterios para la evaluaci√≥n, la selecci√≥n, el seguimiento del desempe√±o y la reevaluaci√≥n de los proveedores externos bas√°ndonos en su capacidad para proporcionar procesos o productos y servicios de acuerdo con los requisitos.

Conservamos registros de estas actividades y de cualquier acci√≥n necesaria que surja de las evaluaciones.</p>`,


"8.4.2": `<h4>8.4.2 Tipo y alcance de control de los procesos, productos y servicios suministrados externamente</h4><p>8.4.2 Tipo y alcance de control de los procesos, productos y servicios suministrados externamenteSGC-4400-45 Rev: 1


En Aceites y L√≠pidos BD nos aseguramos que los productos y servicios suministrados externamente no afectan de manera adversa nuestra capacidad de entregar productos y servicios conformes de manera coherente a nuestros Clientes, para lo cual:

Nos aseguramos de que las etapas de proceso suministrados externamente permanecen dentro del control de nuestro Sistema de Gesti√≥n de la Calidad;
Definimos los controles que pretendemos aplicar a un proveedor externo y los que pretende aplicar a las salidas resultantes;
Tenemos en consideraci√≥n:
El impacto potencial de las etapas de procesos, productos y servicios suministrados externamente en nuestra capacidad de cumplir regularmente los requisitos del Cliente y los legales y reglamentarios aplicables;
La eficacia de los controles aplicados por el proveedor externo;
Determinar la verificaci√≥n u otras actividades, necesarias para asegurarnos de que los procesos, productos y servicios suministrados externamente cumplen los requisitos.</p>`,



"8.4.3": `<h4>8.4.3 Informaci√≥n para los proveedores externos</h4><p>8.4.3 Informaci√≥n para los proveedores externosSGC-4400-46 Rev: 1


En Aceites y L√≠pidos BD nos aseguramos de la adecuaci√≥n de los requisitos antes de su comunicaci√≥n al proveedor externo.

Comunicamos a los proveedores externos nuestros requisitos para:

 

Los procesos, servicios y productos a proporcionar;
La aprobaci√≥n de:
Productos y servicios;
M√©todos, proceso y equipo;
La liberaci√≥n de servicios y productos;
La competencia incluyendo cualquier calificaci√≥n de las personas requeridas;
Las interacciones del proveedor externo con Aceites y L√≠pidos BD;
El control y el seguimiento del desempe√±o del proveedor externo a aplicar por Aceites y L√≠pidos BD;
Las actividades de verificaci√≥n o validaci√≥n que nosotros, o nuestros Clientes, pretenden llevar a cabo en las instalaciones del proveedor externo.</p>`,





 "8.5.1": `<h4>8.5.1 Control de la producci√≥n y de la provisi√≥n del servicio.</h4><p>8.5.1 Control de la producci√≥n y de la provisi√≥n del servicio.SGC-4400-47 Rev: 1


En Aceites y L√≠pidos BD implementamos el proceso de Ventas (SGC-4400-72) para asegurarnos de que la producci√≥n y prestaci√≥n del servicio se d√© bajo condiciones controladas.

Las condiciones controladas incluyen, cuando sea aplicable:

La disponibilidad de documentos que definen (ver los procesos de Ventas Ventas (SGC-4400-72) y de Producci√≥n y distribuci√≥n (SGC-4400-74))
Las caracter√≠sticas de los productos a producir, servicios a prestar, o las actividades a desempe√±ar, que son la formulaci√≥n, fabricaci√≥n y distribuci√≥n de aceites y mantecas comestibles;
Los resultados a alcanzar;
La disponibilidad y el uso de los recursos de seguimiento y medici√≥n adecuados;
La implementaci√≥n de actividades de seguimiento y medici√≥n en las etapas apropiadas para verificar que se cumplen los criterios para el control de los procesos o las salidas, y los criterios de aceptaci√≥n para los productos y servicios;
El uso de la infraestructura y el ambiente adecuados para la operaci√≥n de los procesos;
La designaci√≥n de personas competentes, incluyendo cualquier calificaci√≥n requerida;
La validaci√≥n y revalidaci√≥n peri√≥dica de la capacidad para alcanzar los resultados planificados de los procesos de producci√≥n y mediante las validaciones previstas en el proceso de Producci√≥n y distribuci√≥n (SGC-4400-74);
La implementaci√≥n de acciones para prevenir los errores humanos;
La implementaci√≥n de actividades de liberaci√≥n, entrega y posteriores a la entrega de productos y servicios.</p>`,


"8.5.2": `<h4>8.5.2 Identificaci√≥n y trazabilidad</h4><p>8.5.2 Identificaci√≥n y trazabilidadSGC-4400-48 Rev: 1


En Aceites y L√≠pidos BD utilizamos medios adecuados para identificar las salidas para asegurar la conformidad de los productos y servicios, mediante la orden de compra y nombre del cliente. 

La identificaci√≥n del estado de las salidas con respecto a los requisitos de seguimiento y medici√≥n a trav√©s de la producci√≥n y prestaci√≥n del servicio, mediante el registro de la no conformidad asociada para aquellos servicios que incumplan alg√∫n requisito, los servicios que no disponen de registro de no conformidad han sido liberados de conformidad a los requisitos comprometidos.

En Aceites y L√≠pidos BD controlamos la identificaci√≥n √∫nica de las salidas. Conservando la informaci√≥n documentada necesaria para permitir la trazabilidad.</p>`,


"8.5.3": `<h4>8.5.3 Propiedad perteneciente a los Clientes o proveedores externos</h4><p>8.5.3 Propiedad perteneciente a los Clientes o proveedores externos SGC-4400-49 Rev: 1


En Aceites y L√≠pidos BD cuidamos la propiedad perteneciente a los clientes mientras este bajo nuestro control. Identificamos, verificamos, protegemos y salvaguardamos la propiedad de nuestros Clientes.

Cuando la propiedad es de nuestros Clientes o Proveedores, mientras est√© bajo nuestro control o est√© siendo utilizada por la misma, Aceites y L√≠pidos BD identifica, verifica, protege y salvaguarda la propiedad, por ejemplo: bidones, cubetas o tambores del cliente para el transvase del producto, los datos personales y la informaci√≥n que nos proporciona para los tr√°mites administrativos y el otorgamiento de nuestros servicios.

Cuando la propiedad de un Cliente se pierda, deteriore o que de alg√∫n otro modo se vea afectada, informamos de esto al cliente y conservamos registros sobre lo que ha ocurrido, mediante registro de no conformidad.

Nota 1: La propiedad de un cliente o de un proveedor externo quedar√° bajo resguardo de Aceites y L√≠pidos BD por un periodo m√°ximo de 8 d√≠as h√°biles; Posterior a este tiempo ser√° desechado.  

Nota 2: En Aceites y L√≠pidos BD se destinar√° un √°rea para resguardo de material en general.</p>`,




"8.5.4": `<h4>8.5.4 Preservaci√≥n</h4><p>8.5.4 Preservaci√≥nSGC-4400-50 Rev: 1


En Aceites y L√≠pidos BD preservamos los insumos necesarios para la prestaci√≥n de nuestros servicios, en la medida necesaria para asegurarnos de la conformidad con los requisitos.

Lo anterior se encuentra previsto en el proceso de Producci√≥n y distribuci√≥n (SGC-4400-74).

La preservaci√≥n incluye la identificaci√≥n, el manejo, el empaque, el almacenamiento, el transporte, y la protecci√≥n de los aceites y mantecas comestibles. </p>`,



"8.5.5": `<h4>8.5.5 Actividades posteriores a la entrega</h4><p>8.5.5 Actividades posteriores a la entregaSGC-4400-51 Rev: 1


En Aceites y L√≠pidos BD cumplimos los requisitos para las actividades posteriores a la entrega asociadas con los productos y servicios mediante la aplicaci√≥n de los procesos de Ventas (SGC-4400-72) y de Producci√≥n y distribuci√≥n (SGC-4400-74).

Al determinar el alcance de las actividades posteriores a la entrega que se requieren, consideramos:

Los requisitos legales y reglamentarios;
Las potenciales consecuencias no deseadas asociadas con sus productos y servicios;
La naturaleza, el uso y la vida prevista de los productos y servicios;
Los requisitos del Cliente;
Retroalimentaci√≥n del cliente.
Las actividades posteriores a la entrega incluyen acciones cubiertas por la asesor√≠a de utilizaci√≥n de nuestros productos y reciclamos envases que cumplen con su tiempo de vida.</p>`,



"8.5.6": `<h4>8.5.6 Control de los cambios</h4><p>8.5.6 Control de los cambiosSGC-4400-52 Rev: 1


En Aceites y L√≠pidos BD revisamos y controlamos los cambios para la producci√≥n o prestaci√≥n del servicio mediante la aplicaci√≥n de los procesos de Ventas (SGC-4400-72) y de Producci√≥n y distribuci√≥n (SGC-4400-74) en la medida necesaria para asegurarnos de la conformidad continua con los requisitos especificados.

Conservamos registros que describen los resultados de la revisi√≥n de los cambios, las personas que autorizan el cambio y de cualquier acci√≥n necesaria que surja de la revisi√≥n.</p>`,



    "8.6": `<h4>8.6 Liberaci√≥n de los productos y servicios</h4><p>8.6 Liberaci√≥n de los productos y serviciosSGC-4400-53 Rev: 1


En Aceites y L√≠pidos BD implementamos las disposiciones planificadas en las etapas adecuadas de los procesos de Ventas (SGC-4400-72) y de Producci√≥n y distribuci√≥n (SGC-4400-74) para verificar que se cumplen los requisitos de los productos y servicios de Formulaci√≥n, fabricaci√≥n y distribuci√≥n de aceites y mantecas comestibles.

La liberaci√≥n de los productos y servicios al cliente no se lleva a cabo hasta que se hayan completado satisfactoriamente las disposiciones planificadas, a menos que sea aprobado de otra manera por una autoridad pertinente, y cuando sea aplicable por el Cliente.

En Aceites y L√≠pidos BD conservamos registros sobre la liberaci√≥n de los productos y servicios. √âstos incluyen:

Evidencia de la conformidad con los criterios de aceptaci√≥n;
Trazabilidad a las personas que han autorizado la liberaci√≥n.</p>`,


   "8.7.1": `<h4>8.7.1 Generalidades del control de las salidas no conformes</h4><p>8.7.1 Generalidades del control de las salidas no conformesSGC-4400-54 Rev: 1


En Aceites y L√≠pidos BD nos aseguramos de que las salidas que no sean conformes con los requisitos se identifican y se controlan para prevenir su uso o entrega no intencional.

Tomamos las acciones adecuadas bas√°ndonos en la naturaleza de la no conformidad y su efecto sobre la conformidad de los productos y servicios de Formulaci√≥n, fabricaci√≥n y distribuci√≥n de aceites y mantecas comestibles. Esto se aplica tambi√©n a los productos y servicios no conformes detectados despu√©s de la entrega de los productos, durante o despu√©s de la provisi√≥n de los servicios.

Tratar las salidas no conformes de una o m√°s de las siguientes maneras:

Correcci√≥n;
Separaci√≥n, contenci√≥n, devoluci√≥n o suspensi√≥n de la provisi√≥n de productos y servicios;
Informar al cliente;
Obtener autorizaci√≥n para su aceptaci√≥n bajo concesi√≥n.
Verificamos la conformidad con los requisitos cuando las salidas no conformes se corrigen.

La explicaci√≥n de lo anterior se encuentra descrito en el procedimiento de Control de no conformidades (PRO-8700-01).</p>`,


"8.7.2": `<h4>8.7.2 Informaci√≥n documentada de las salidas no conformes</h4><p>8.7.2 Informaci√≥n documentada de las salidas no conformesSGC-4400-55 Rev: 1


En Aceites y L√≠pidos BD, conforme a lo descrito en el procedimiento de Control de no conformidades (PRO-8700-01), conservamos registro (ver REG-8720-02) que:

Describe la no conformidad;
Describe las acciones tomadas
Describe todas las concesiones obtenidas
Identifica la autoridad que decide la acci√≥n con respecto a la no conformidad.</p>`,








    //9.0

"9.1.1": `<h4>9.1.1 Generalidades del seguimiento, medici√≥n, an√°lisis y evaluaci√≥n</h4><p>9.1.1 Generalidades del seguimiento, medici√≥n, an√°lisis y evaluaci√≥nSGC-4400-56 Rev: 1


En Aceites y L√≠pidos BD, a trav√©s de la aplicaci√≥n del proceso Estrat√©gico (SGC-4400-70), determinamos:

El seguimiento y medici√≥n de: los procesos del Sistema de Gesti√≥n de la Calidad, la conformidad de los servicios de impresos y empaques y la satisfacci√≥n de clientes;
Los m√©todos de seguimiento, medici√≥n, an√°lisis y evaluaci√≥n necesarios, para asegurar resultados v√°lidos;
Cu√°ndo se debe llevar a cabo el seguimiento y la medici√≥n;
Cu√°ndo se deben analizar y evaluar los resultados del seguimiento y la medici√≥n.
En Aceites y L√≠pidos BD evaluamos el desempe√±o y la eficacia del sistema de gesti√≥n de la calidad mediante la medici√≥n del proceso Estrat√©gico (SGC-4400-70).

Conservamos informaci√≥n documentada como evidencia de los resultados mediante la aplicaci√≥n de las mediciones consideradas en el presente requisito.</p>`,






"9.1.2": `<h4>9.1.2 Satisfacci√≥n del Cliente</h4><p>9.1.2 Satisfacci√≥n del ClienteSGC-4400-57 Rev: 1


En Aceites y L√≠pidos BD realizamos el seguimiento de las percepciones de los clientes del grado en que se cumplan sus necesidades y expectativas. Determinar los m√©todos para obtener, realizar el seguimiento y revisar esta informaci√≥n conforme se encuentra previsto en el proceso Estrat√©gico (SGC-4400-70).

La realizaci√≥n del seguimiento de las percepciones del cliente incluye: las encuestas al Cliente, la retroalimentaci√≥n del Cliente sobre los productos o servicios entregados, recompra, recomendaciones de clientes, etc.</p>`,



    "9.1.3": `<h4>9.1.3 An√°lisis y evaluaci√≥n</h4><p>9.1.3 An√°lisis y evaluaci√≥nSGC-4400-58 Rev: 1

En Aceites y L√≠pidos BD implementamos el proceso Estrat√©gico (SGC-4400-70) para analizar y evaluar los datos y la informaci√≥n apropiados originados por el seguimiento y la medici√≥n.

Los resultados del an√°lisis y la evaluaci√≥n son utilizados para evaluar:
La conformidad de los productos y servicios otorgados por Aceites y L√≠pidos BD (ver requisito 8.6 SGC-4400-53);
El grado de satisfacci√≥n del Cliente, ver requisito 9.1.2 (SGC-4400-57);
El desempe√±o (ver requisito 9.2.1, SGC-4400-59) y la eficacia del sistema de gesti√≥n de la calidad (ver requisito 4.4.1g, SGC-4400-05);
Si lo planificado se ha implementado de forma eficaz (ver requisito 9.3.2 en SGC-4400-62);
La eficacia de las acciones tomadas para abordar los riesgos y oportunidades, ver requisito 9.3.2 del presente sistema de gesti√≥n de la calidad (SGC-4400-62);
El desempe√±o de los proveedores externos (ver requisito 8.4.1 en SGC-4400-44);
La necesidad de mejoras en el sistema de gesti√≥n de la calidad (ver requisito 10.1 en SGC-4400-64).
Los m√©todos para analizar los datos incluyen t√©cnicas estad√≠sticas.</p>`,


    "9.2.1": `<h4>9.2.1 Generalidades de Auditor√≠a Interna</h4><p>9.2.1 Generalidades de la Auditor√≠a internaSGC-4400-59 Rev: 1


En Aceites y L√≠pidos BD llevamos a cabo auditor√≠as internas a intervalos planificados para proporcionar informaci√≥n acerca de si el Sistema de Gesti√≥n de la Calidad:

es conforme con: 
los requisitos propios de la organizaci√≥n para su Sistema de Gesti√≥n de la Calidad;
los requisitos de la norma ISO 9001:2015 
se implementa y mantiene eficazmente.</p>`,

    "9.2.2": `<h4>9.2.2 Auditor√≠a interna</h4><p>9.2.2 Auditor√≠a internaSGC-4400-60 Rev: 1


En Aceites y L√≠pidos BD:

Planificamos, establecemos, implementamos y mantenemos el Programa de trabajo para la certificaci√≥n, mantenimiento y mejora del SGC  que incluye la frecuencia, los m√©todos, las responsabilidades, los requisitos de planificaci√≥n y la elaboraci√≥n de informes, que deben tener en consideraci√≥n la importancia de los procesos involucrados, los cambios que afecten a la organizaci√≥n y los resultados de auditor√≠as previas; 
definimos los criterios de la auditoria y el alcance para cada auditor√≠a;
seleccionamos los auditores y llevamos a cabo auditor√≠as para asegurarse de la objetividad y la imparcialidad del proceso de auditor√≠a; 
nos aseguramos de que los resultados de las auditor√≠as se informen a la Alta Direcci√≥n, 
realizamos las correcciones y tomar las acciones correctivas adecuadas sin demora injustificada;
conservamos informaci√≥n documentada que sirven como evidencia de la implementaci√≥n del procedimiento de Auditor√≠a Interna (PRO-9220-01) y de los resultados de la auditor√≠a.</p>`,

    "9.3.1": `<h4>9.3.1 Generalidades de la Revisi√≥n</h4><p>9.3.1 Generalidades de la Revisi√≥n por la Direcci√≥nSGC-4400-61 Rev: 1


La Alta Direcci√≥n mediante actividades previstas desde el proceso Estrat√©gico (SGC-4400-70), revisa el sistema de gesti√≥n de la calidad de Aceites y L√≠pidos BD a intervalos planificados anualmente, para asegurarnos de su conveniencia (que es √∫til para lo que fue creado), adecuaci√≥n (proximidad entre lo descrito y la realidad de nuestra organizaci√≥n), eficacia (que se alcanzan los objetivos de calidad trazados y en consecuencia se cumple la pol√≠tica de la calidad) y alineaci√≥n con la direcci√≥n estrat√©gica (promoviendo seguir el rumbo trazado desde la visi√≥n) de Aceites y L√≠pidos BD (SGC-4400-01).</p>`,

    "9.3.2": `<h4>9.3.2 Entradas de la revisi√≥n</h4><p>9.3.2 Entradas de la revisi√≥n por la direcci√≥nSGC-4400-62 Rev: 1


La revisi√≥n por la direcci√≥n se planifica y lleva a cabo incluyendo consideraciones sobre:

El estado de las acciones de las revisiones de la direcci√≥n previas, confirmando el grado de cumplimiento de los compromisos establecidos en la minuta de la revisi√≥n por la direcci√≥n del periodo anterior;
Los cambios en las cuestiones externas e internas que sean pertinentes al sistema de gesti√≥n de la calidad considerando el contexto de la organizaci√≥n, actualizando el an√°lisis establecido en el requisito 4.1 del presente documento (SGC-4400-02) e identificando los cambios en riesgos que hubieran desaparecido, riesgos nuevos, oportunidades que hubieran mantenido y las que hubieran desaparecido; 
La informaci√≥n sobre el desempe√±o y la eficacia del sistema de gesti√≥n de la calidad, incluidas las tendencias relativas a:
Satisfacci√≥n del cliente (ver requisito 9.1.2 en SGC-4400-57), y la retroalimentaci√≥n de las partes interesadas pertinentes identificando si fuera el caso, que alguna parte interesada hubiera retroalimentado informaci√≥n;
El grado en que se han cumplido los objetivos de la calidad (Ver requisito 4.4.1g en SGC-4400-05);
El desempe√±o del proceso (ver requisito 4.4.1g en SGC-4400-05) y conformidad de los productos y servicios (ver requisito 8.6 en SGC-4400-53);
No conformidades (ver REG-8720-01) y acciones correctivas conforme se describe en el requisito 10.2.1 (SGC-4400-65);
Resultados de seguimiento y medici√≥n conforme se describe en el requisito 9.1.3 (SGC-4400-58);
Resultados de las auditor√≠as (SGC-4400-60);
El desempe√±o de los proveedores externos (SGC-4400-46);
Adecuaci√≥n de los recursos (SGC-4400-18);
La eficacia de las acciones tomadas para tratar los riesgos y las oportunidades con base en aquellos riesgos que hubieran desaparecido o reducido su impacto por acciones tomadas o bien el aprovechamiento de oportunidades;
Oportunidades de mejora.</p>`,

"9.3.3": `<h4>9.3.3 Salidas de la revisi√≥n por la direcci√≥n</h4><p>9.3.3 Salidas de la revisi√≥n por la direcci√≥nSGC-4400-63 Rev: 1


Las salidas de la revisi√≥n por la direcci√≥n incluyen las decisiones y acciones relacionadas con:

Las oportunidades de mejora;
Cualquier necesidad de cambio en el sistema de gesti√≥n de calidad;
Las necesidades de recursos.
En Aceites y L√≠pidos BD conservamos la minuta de la reuni√≥n (REG-9330-01) como evidencia de los resultados de las revisiones por la direcci√≥n.</p>`,

    //10.0
    "10.1": `<h4>10.1 Generalidades de la Mejora</h4><p>10.1 Generalidades de la MejoraSGC-4400-64 Rev: 1


En Aceites y L√≠pidos BD mediante la aplicaci√≥n del proceso de Direcci√≥n Estrat√©gico (SGC-4400-70) determinamos y seleccionamos las oportunidades de mejora e implementamos cualquier acci√≥n necesaria para cumplir los requisitos de nuestros Clientes, y aumentar la satisfacci√≥n de los mismos.

√âstas incluyen:

 

Mejorar los servicios para cumplir los requisitos, as√≠ como tratar las necesidades y expectativas futuras;
Corregir, prevenir o reducir los efectos no deseados;
Mejorar el desempe√±o y la eficacia del sistema de gesti√≥n de la calidad.</p>`,

    "10.2.1": `<h4>10.2.1 Generalidades de no conformidades</h4><p>10.2.1 Generalidades de no conformidades y acci√≥n correctivaSGC-4400-65 Rev: 1


Cuando ocurra una no conformidad, incluida cualquier originada por quejas, en Aceites y L√≠pidos BD, desde la aplicaci√≥n del proceso Estrat√©gico (SGC-4400-70):

Reaccionamos ante la no conformidad y cuando sea aplicable:
Tomamos acciones para controlarla y corregirla;
Hacemos frente a las consecuencias;
Mediante la aplicaci√≥n del Procedimiento de Acci√≥n Correctiva (PRO-1022-01), evaluamos la necesidad de acciones para eliminar las causas de la no conformidad, con el fin de que no vuelva a ocurrir, ni ocurra en otra parte, mediante:
La revisi√≥n y el an√°lisis de la no conformidad (REG-8720-02);
La determinaci√≥n de las causas de la no conformidad;
La determinaci√≥n de si existen no conformidades similares, o que potencialmente podr√≠an ocurrir;
Implementamos cualquier acci√≥n necesaria;
Revisamos la eficacia de cualquier acci√≥n correctiva tomada;
Si es necesario, actualizar los riesgos y oportunidades determinados durante la planificaci√≥n;
Si es necesario, hacer cambios al sistema de gesti√≥n de la calidad.
Las acciones correctivas son adecuadas a los efectos de las no conformidades encontradas.</p>`,

    "10.2.2": `<h4>10.2.2 Informaci√≥n documentada</h4><p>10.2.2 Informaci√≥n documentada de no conformidad y acci√≥n correctivaSGC-4400-66 Rev: 1


En Aceites y L√≠pidos BD conservamos registro (REG-8720-02) como evidencia de:

la naturaleza de las no conformidades y cualquier acci√≥n tomada posteriormente
los resultados de cualquier acci√≥n correctiva.
Conforme se describe en el Procedimiento de Control de No Conformidades (PRO-8700-01).</p>`,

    "10.3": `<h4>10.3 Mejora continua</h4><p>10.3 Mejora continuaSGC-4400-67 Rev: 1


En Aceites y L√≠pidos BD aplicamos el proceso Estrat√©gico (SGC-4400-70) mejoramos continuamente la idoneidad, adecuaci√≥n y eficacia del Sistema de Gesti√≥n de la Calidad.

En Aceites y L√≠pidos BD consideramos los resultados del an√°lisis y la evaluaci√≥n, y las salidas de la revisi√≥n por la direcci√≥n, para determinar si hay necesidades u oportunidades que deben tratarse como parte de la mejora continua.</p>`



  };

  let detailHtml = detalleTexto[item] || `<h4>${item}</h4><p>Detalle no disponible.</p>`;
  detalleDiv.innerHTML = detailHtml;
}

// Asegurar que las funciones est√©n disponibles en el √°mbito global
window.handleRequisitosTab = handleRequisitosTab;
window.toggleSubMenu = toggleSubMenu;
window.mostrarDetalle = mostrarDetalle;

// Cargar la pesta√±a "Contexto" autom√°ticamente
window.onload = function () {
  handleRequisitosTab('contexto');
};





//FUNCION PARA ORGRANIGRAMA 
document.addEventListener("DOMContentLoaded", function () {
    const modal = document.getElementById("orgChartModal");
    const closeBtn = document.getElementById("closeOrgChart");
    const openOrgChartBtn = document.getElementById("openOrgChart");

    // Mostrar el modal
    openOrgChartBtn.addEventListener("click", () => {
        modal.style.display = "block";
    });

    // Cerrar el modal
    closeBtn.onclick = () => {
        modal.style.display = "none";
    };

    // Cerrar el modal al hacer clic fuera del contenido
    window.onclick = (event) => {
        if (event.target === modal) {
            modal.style.display = "none";
        }
    };
});

//FUNCION PARA PROCESOS 
// Variables para la paginaci√≥n
let currentPageProcedimientos = 1;
const itemsPerPageProcedimientos = 5;

// Funci√≥n para cargar los archivos de procedimientos con paginaci√≥n
async function loadProcedimientosPaginated() {
    const fileTableBody = document.getElementById("fileTableBody-procedimientos");
    const paginationContainer = document.getElementById("pagination-container-procedimientos");
    fileTableBody.innerHTML = "";
    paginationContainer.innerHTML = "";

    // Obtener todos los archivos desde Firestore
    const querySnapshot = await getDocs(collection(db, "files-procedimientos"));
    const files = [];
    querySnapshot.forEach((doc) => {
        files.push(doc.data());
    });

    // Ordenar los archivos por nombre para consistencia
    files.sort((a, b) => a.name.localeCompare(b.name));

    // Calcular el n√∫mero total de p√°ginas
    const totalPages = Math.ceil(files.length / itemsPerPageProcedimientos);

    // Validar que la p√°gina actual no exceda el total de p√°ginas
    if (currentPageProcedimientos > totalPages) {
        currentPageProcedimientos = totalPages;
    }

    // Obtener los archivos de la p√°gina actual
    const start = (currentPageProcedimientos - 1) * itemsPerPageProcedimientos;
    const end = start + itemsPerPageProcedimientos;
    const currentFiles = files.slice(start, end);

    // Mostrar los archivos en la tabla
    currentFiles.forEach((fileData) => {
        const row = document.createElement("tr");

        const titleCell = document.createElement("td");
        titleCell.textContent = fileData.name;

        const codeCell = document.createElement("td");
        codeCell.textContent = fileData.code || "C√≥digo no encontrado";

        const fileCell = document.createElement("td");
        if (fileData.url) {
            const link = document.createElement("a");
            link.href = fileData.url;
            link.target = "_blank";
            link.classList.add("file-link");
            link.innerHTML = `<img src="https://img.icons8.com/ios-filled/50/000000/pdf.png" class="icon" /> Ver archivo`;
            fileCell.appendChild(link);
        } else {
            fileCell.textContent = "Sin Archivo";
            fileCell.classList.add("no-file");
        }

        row.appendChild(titleCell);
        row.appendChild(codeCell);
        row.appendChild(fileCell);
        fileTableBody.appendChild(row);
    });

    // Crear botones de paginaci√≥n
    for (let i = 1; i <= totalPages; i++) {
        const button = document.createElement("button");
        button.textContent = i;
        button.classList.add("pagination-button");
        if (i === currentPageProcedimientos) button.classList.add("active");
        button.addEventListener("click", () => {
            currentPageProcedimientos = i;
            loadProcedimientosPaginated();
        });
        paginationContainer.appendChild(button);
    }
}

// Subir archivos de procedimientos
document.getElementById("uploadBtn-procedimientos").addEventListener("click", async () => {
    const fileInput = document.getElementById("fileInput-procedimientos");
    const file = fileInput.files[0];

    if (!file) {
        alert("Por favor seleccione un archivo para subir.");
        return;
    }

    const code = await extractCodeFromPDF(file);

    try {
        const fileName = file.name;
        const storageRef = ref(storage, `uploads/procedimientos/${fileName}`);
        await uploadBytes(storageRef, file);
        const downloadURL = await getDownloadURL(storageRef);

        await addDoc(collection(db, "files-procedimientos"), {
            name: fileName,
            url: downloadURL,
            code: code,
            date: new Date().toLocaleDateString()
        });

        loadProcedimientosPaginated();
        fileInput.value = "";
    } catch (error) {
        console.error("Error al subir el archivo:", error.message);
        alert("Error al subir el archivo: " + error.message);
    }
});

// Cargar los archivos de procedimientos al inicio
document.getElementById("tab-procedimientos").addEventListener("click", () => {
    showTabContent("procedimientos");
    loadProcedimientosPaginated();
});


// Manejar el clic en la pesta√±a "Pol√≠tica de Inocuidad"
document.getElementById("tab-inocuidad").addEventListener("click", () => {
    showTabContent("inocuidad");
});







//BOTON DE BUSQUEDA 



// Funci√≥n para buscar en todas las subcolecciones relacionadas con las pesta√±as
// Funci√≥n para buscar en todas las subcolecciones relacionadas con las pesta√±as
async function searchFilesInTabs(searchQuery) {
    try {
        // Lista de subcolecciones que corresponden a las pesta√±as
        const tabCollections = {
            documentada: "files-documentada",
            externos: "files-externos",
            registros: "files-registros",
            perfil: "files-perfil",
            responsabilidades: "files-responsabilidades",
            SGC: "files-SGC",
        };

        let results = [];

        // Iterar sobre todas las subcolecciones
        for (const [tab, collectionName] of Object.entries(tabCollections)) {
            const collectionRef = collection(db, collectionName);
            const querySnapshot = await getDocs(collectionRef);

            // Buscar coincidencias dentro de cada subcolecci√≥n
            querySnapshot.forEach((doc) => {
                const fileData = doc.data();

                // Verificar coincidencias en cualquier campo del documento
                const isMatch = Object.values(fileData).some((value) => {
                    if (typeof value === "string") {
                        return value.toLowerCase().includes(searchQuery); // Comparar en min√∫sculas
                    }
                    return false;
                });

                if (isMatch) {
                    results.push({ id: doc.id, tab, ...fileData }); // Guardar coincidencias junto con la pesta√±a
                }
            });
        }

        // **Ordenar resultados por c√≥digo**
        results.sort((a, b) => {
            if (a.code && b.code) {
                const numA = parseInt(a.code.match(/\d+/)?.[0] || 0);
                const numB = parseInt(b.code.match(/\d+/)?.[0] || 0);
                return numA - numB;
            }
            if (a.code && !b.code) return -1;
            if (!a.code && b.code) return 1;
            return 0;
        });

        return results;
    } catch (error) {
        console.error("Error al buscar archivos:", error);
        throw new Error("No se pudo realizar la b√∫squeda.");
    }
}

// Evento para el bot√≥n de b√∫squeda
document.getElementById("searchButtonLists").addEventListener("click", async () => {
    const searchQuery = document.getElementById("searchInputLists").value.trim().toLowerCase();

    if (!searchQuery) {
        alert("Por favor, escribe algo para buscar.");
        return;
    }

    try {
        const results = await searchFilesInTabs(searchQuery);

        // Limpiar tabla
        const tableBody = document.getElementById("fileTableBody-lists");
        tableBody.innerHTML = "";

        // Mostrar resultados en la tabla
        if (results.length === 0) {
            tableBody.innerHTML = "<tr><td colspan='3'>No se encontraron resultados.</td></tr>";
        } else {
            results.forEach((file) => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${file.name || "Sin t√≠tulo"}</td>
                    <td>${file.code || "Sin c√≥digo"}</td>
                    <td>
                        ${file.url ? `<a href="${file.url}" target="_blank" class="file-link">
                            Ver archivo
                        </a>` : "Sin archivo"}
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }
    } catch (error) {
        console.error("Error al procesar la b√∫squeda:", error);
        alert("Hubo un error al buscar los archivos. Int√©ntalo nuevamente.");
    }
});


// Evento para el bot√≥n de b√∫squeda
document.getElementById("searchButtonLists").addEventListener("click", async () => {
    const searchQuery = document.getElementById("searchInputLists").value.trim().toLowerCase();

    if (!searchQuery) {
        alert("Por favor, escribe algo para buscar.");
        return;
    }

    try {
        const results = await searchFilesInTabs(searchQuery);

        // Limpiar tabla
        const tableBody = document.getElementById("fileTableBody-lists");
        tableBody.innerHTML = "";

        // Mostrar resultados en la tabla
        if (results.length === 0) {
            tableBody.innerHTML = "<tr><td colspan='3'>No se encontraron resultados.</td></tr>";
        } else {
            results.forEach((file) => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${file.name || "Sin t√≠tulo"}</td>
                    <td>${file.code || "Sin c√≥digo"}</td>
                    <td>
                        <a href="${file.url}" target="_blank" class="file-link">
                            Ver archivo
                        </a>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }
    } catch (error) {
        console.error("Error al procesar la b√∫squeda:", error);
        alert("Hubo un error al buscar los archivos. Int√©ntalo nuevamente.");
    }
});










// Funci√≥n para verificar si el archivo o c√≥digo ya existe en Firebase (busca coincidencias parciales)
async function checkFileOrCodeExists(fileName, fileCode) {
    try {
        const querySnapshot = await getDocs(collection(db, "files"));
        let existingFiles = [];

        querySnapshot.forEach((doc) => {
            const fileData = doc.data();
            if (
                fileData.name.toLowerCase().includes(fileName.toLowerCase()) || 
                (fileData.code && fileData.code.toLowerCase().includes(fileCode.toLowerCase()))
            ) {
                existingFiles.push(fileData);
            }
        });

        return existingFiles;
    } catch (error) {
        console.error("Error al verificar archivo o c√≥digo:", error);
        return [];
    }
}

// Funci√≥n para mostrar el modal de confirmaci√≥n elegante
function showConfirmationModal(fileName, existingFiles, onConfirm, onCancel) {
    // Crear modal din√°mico
    const modal = document.createElement("div");
    modal.id = "confirmationModal";
    modal.style.position = "fixed";
    modal.style.top = "0";
    modal.style.left = "0";
    modal.style.width = "100%";
    modal.style.height = "100%";
    modal.style.backgroundColor = "rgba(0, 0, 0, 0.6)";
    modal.style.display = "flex";
    modal.style.justifyContent = "center";
    modal.style.alignItems = "center";
    modal.style.zIndex = "1000";

    // Contenido del modal
    modal.innerHTML = `
        <div style="background: white; padding: 20px; border-radius: 15px; text-align: center; width: 90%; max-width: 500px; box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);">
            <h2 style="font-size: 22px; color: #00b954; margin-bottom: 15px;">Conflicto de Archivo</h2>
            <p style="font-size: 16px; margin-bottom: 20px;">El archivo "<strong>${fileName}</strong>" coincide con:</p>
            <ul style="text-align: left; margin-bottom: 20px; font-size: 14px; color: #333;">
                ${existingFiles.map(file => `<li>‚Ä¢ ${file.name} (C√≥digo: ${file.code || 'Sin c√≥digo'})</li>`).join('')}
            </ul>
            <p style="font-size: 14px; margin-bottom: 20px;">¬øDeseas continuar con la subida?</p>
            <button id="confirmButton" style="margin-right: 10px; padding: 10px 20px; background-color: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer;">Continuar</button>
            <button id="cancelButton" style="padding: 10px 20px; background-color: #dc3545; color: white; border: none; border-radius: 5px; cursor: pointer;">Cancelar</button>
        </div>
    `;

    document.body.appendChild(modal);

    // Manejar los botones
    document.getElementById("confirmButton").addEventListener("click", () => {
        onConfirm();
        modal.remove();
    });

    document.getElementById("cancelButton").addEventListener("click", () => {
        onCancel();
        modal.remove();
    });
}

// Evento de subida de archivos con verificaci√≥n
async function handleFileUpload() {
    const fileInput = document.getElementById("fileInput");
    const file = fileInput.files[0];

    if (!file) {
        alert("Por favor seleccione un archivo para subir.");
        return;
    }

    const fileName = file.name;
    const fileCode = await extractCodeFromPDF(file);

    // Verificar si el archivo o c√≥digo ya existe
    const existingFiles = await checkFileOrCodeExists(fileName, fileCode);

    if (existingFiles.length > 0) {
        // Mostrar modal si hay conflictos
        showConfirmationModal(fileName, existingFiles, async () => {
            await uploadFileToFirebase(file, fileName, fileCode);
        }, () => {
            alert("Subida cancelada.");
        });
    } else {
        // Subir directamente si no existe conflicto
        await uploadFileToFirebase(file, fileName, fileCode);
    }
}

// Funci√≥n para subir el archivo a Firebase
async function uploadFileToFirebase(file, fileName, fileCode) {
    try {
        const storageRef = ref(storage, `uploads/${fileName}`);
        await uploadBytes(storageRef, file);
        const downloadURL = await getDownloadURL(storageRef);

        await addDoc(collection(db, "files"), {
            name: fileName,
            url: downloadURL,
            code: fileCode,
            date: new Date().toLocaleDateString()
        });

        alert("Archivo subido exitosamente.");
        loadFiles();
    } catch (error) {
        console.error("Error al subir el archivo:", error.message);
        alert("Error al subir el archivo: " + error.message);
    }
}

// Asociar el evento al bot√≥n de subida
document.getElementById("uploadBtn").addEventListener("click", handleFileUpload);


// Funci√≥n para mostrar el contenido de cada lista


</script>
</body>
</html>
